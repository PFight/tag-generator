!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var u=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){return function(t){var e=u(t);return c.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=h(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function d(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var y=function(t){function n(e,r,i){var o=t.call(this,r)||this;return o.code=e,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,v.prototype.create),o}return e(n,t),n}(Error),v=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?g(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new y(i,a,r);return u},t}();function g(t,e){return t.replace(m,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var m=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function b(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function w(t,e){var n=new _(t,e);return n.subscribe.bind(n)}var _=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=E),void 0===r.error&&(r.error=E),void 0===r.complete&&(r.complete=E);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function E(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function T(t){return t&&t._delegate?t._delegate:t}var I=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),S="[DEFAULT]",O=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new f;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:S})}catch(t){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var a=s(i.value,2),u=a[0],c=a[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=S),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(a(a([],s(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),s(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=S),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=S),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:a,options:i});try{for(var c=o(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var h=s(l.value,2),f=h[0],p=h[1];a===this.normalizeInstanceIdentifier(f)&&p.resolve(u)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return u},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var s=o(i),a=s.next();!a.done;a=s.next()){var u=a.value;try{u(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===S?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=S),this.component?this.component.multipleInstances?t:S:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var A,C=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new O(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function N(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var D,x=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(D||(D={}));var k,P={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},R=D.INFO,L=((A={})[D.DEBUG]="log",A[D.VERBOSE]="log",A[D.INFO]="info",A[D.WARN]="warn",A[D.ERROR]="error",A),M=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=L[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,N(["["+i+"]  "+t.name+":"],n))}},j=function(){function t(t){this.name=t,this._logLevel=R,this._logHandler=M,this._userLogHandler=null,x.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in D))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?P[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,N([this,D.DEBUG],t)),this._logHandler.apply(this,N([this,D.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,N([this,D.VERBOSE],t)),this._logHandler.apply(this,N([this,D.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,N([this,D.INFO],t)),this._logHandler.apply(this,N([this,D.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,N([this,D.WARN],t)),this._logHandler.apply(this,N([this,D.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,N([this,D.ERROR],t)),this._logHandler.apply(this,N([this,D.ERROR],t))},t}();function F(t){x.forEach((function(e){e.setLogLevel(t)}))}var V,U=((k={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",k["bad-app-name"]="Illegal App name: '{$appName}",k["duplicate-app"]="Firebase App named '{$appName}' already exists",k["app-deleted"]="Firebase App named '{$appName}' already deleted",k["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",k["invalid-log-argument"]="First argument to `onLog` must be null or a function.",k),B=new v("app","Firebase",U),q="@firebase/app",G="[DEFAULT]",z=((V={})[q]="fire-core",V["@firebase/analytics"]="fire-analytics",V["@firebase/app-check"]="fire-app-check",V["@firebase/auth"]="fire-auth",V["@firebase/database"]="fire-rtdb",V["@firebase/functions"]="fire-fn",V["@firebase/installations"]="fire-iid",V["@firebase/messaging"]="fire-fcm",V["@firebase/performance"]="fire-perf",V["@firebase/remote-config"]="fire-rc",V["@firebase/storage"]="fire-gcs",V["@firebase/firestore"]="fire-fst",V["fire-js"]="fire-js",V["firebase-wrapper"]="fire-js-all",V),K=new j("@firebase/app"),H=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=h(void 0,t),this.container=new C(e.name),this._addComponent(new I("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=G),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=G),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){K.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw B.create("app-deleted",{appName:this.name_})},t}();H.prototype.name&&H.prototype.options||H.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function X(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=G);var s=o.name;if("string"!=typeof s||!s)throw B.create("bad-app-name",{appName:String(s)});if(b(e,s))throw B.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=z[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void K.warn(u.join(" "))}o(new I(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:F,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw B.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=P[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:D[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=x;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!b(e,t=t||G))throw B.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return K.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw B.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&h(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Q=function t(){var e=X(H);return e.INTERNAL=n(n({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){h(e,t)},createSubscribe:w,ErrorFactory:v,deepExtend:h}),e}(),W=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){K.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var $=self.firebase.SDK_VERSION;$&&$.indexOf("LITE")>=0&&K.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Y=Q.initializeApp;Q.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return d()&&K.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Y.apply(void 0,t)};var J=Q;!function(t,e){t.INTERNAL.registerComponent(new I("platform-logger",(function(t){return new W(t)}),"PRIVATE")),t.registerVersion(q,"0.6.30",e),t.registerVersion("fire-js","")}(J);var Z="8.10.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
J.registerVersion("firebase",Z,"app"),J.SDK_VERSION=Z;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var tt=function(t,e){return(tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function et(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var nt,rt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},it=it||{},ot=rt||self;function st(){}function at(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ut(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ct="closure_uid_"+(1e9*Math.random()>>>0),lt=0;function ht(t,e,n){return t.call.apply(t.bind,arguments)}function ft(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function pt(t,e,n){return(pt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ht:ft).apply(null,arguments)}function dt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function yt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function vt(){this.s=this.s,this.o=this.o}var gt={};vt.prototype.s=!1,vt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,ct)&&t[ct]||(t[ct]=++lt)}(this);delete gt[t]}},vt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var mt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},bt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function wt(t){return Array.prototype.concat.apply([],arguments)}function _t(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Et(t){return/^[\s\xa0]*$/.test(t)}var Tt,It=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function St(t,e){return-1!=t.indexOf(e)}function Ot(t,e){return t<e?-1:t>e?1:0}t:{var At=ot.navigator;if(At){var Ct=At.userAgent;if(Ct){Tt=Ct;break t}}Tt=""}function Nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Dt(t){var e={};for(var n in t)e[n]=t[n];return e}var xt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<xt.length;o++)n=xt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Pt(t){return Pt[" "](t),t}Pt[" "]=st;var Rt,Lt,Mt=St(Tt,"Opera"),jt=St(Tt,"Trident")||St(Tt,"MSIE"),Ft=St(Tt,"Edge"),Vt=Ft||jt,Ut=St(Tt,"Gecko")&&!(St(Tt.toLowerCase(),"webkit")&&!St(Tt,"Edge"))&&!(St(Tt,"Trident")||St(Tt,"MSIE"))&&!St(Tt,"Edge"),Bt=St(Tt.toLowerCase(),"webkit")&&!St(Tt,"Edge");function qt(){var t=ot.document;return t?t.documentMode:void 0}t:{var Gt="",zt=(Lt=Tt,Ut?/rv:([^\);]+)(\)|;)/.exec(Lt):Ft?/Edge\/([\d\.]+)/.exec(Lt):jt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Lt):Bt?/WebKit\/(\S+)/.exec(Lt):Mt?/(?:Version)[ \/]?(\S+)/.exec(Lt):void 0);if(zt&&(Gt=zt?zt[1]:""),jt){var Kt=qt();if(null!=Kt&&Kt>parseFloat(Gt)){Rt=String(Kt);break t}}Rt=Gt}var Ht,Xt={};function Qt(){return function(t){var e=Xt;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=It(String(Rt)).split("."),n=It("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Ot(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Ot(0==o[2].length,0==s[2].length)||Ot(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(ot.document&&jt){var Wt=qt();Ht=Wt||(parseInt(Rt,10)||void 0)}else Ht=void 0;var $t=Ht,Yt=function(){if(!ot.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ot.addEventListener("test",st,e),ot.removeEventListener("test",st,e)}catch(t){}return t}();function Jt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Zt(t,e){if(Jt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ut){t:{try{Pt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:te[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Zt.Z.h.call(this)}}Jt.prototype.h=function(){this.defaultPrevented=!0},yt(Zt,Jt);var te={2:"touch",3:"pen",4:"mouse"};Zt.prototype.h=function(){Zt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ee="closure_listenable_"+(1e6*Math.random()|0),ne=0;function re(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++ne,this.ca=this.fa=!1}function ie(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function oe(t){this.src=t,this.g={},this.h=0}function se(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=mt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ie(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ae(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}oe.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=ae(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new re(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var ue="closure_lm_"+(1e6*Math.random()|0),ce={};function le(t,e,n,r,i){if(r&&r.once)return fe(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)le(t,e[o],n,r,i);return null}return n=be(n),t&&t[ee]?t.N(e,n,ut(r)?!!r.capture:!!r,i):he(t,e,n,!1,r,i)}function he(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ut(i)?!!i.capture:!!i,a=ge(t);if(a||(t[ue]=a=new oe(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=ve;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Yt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ye(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function fe(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)fe(t,e[o],n,r,i);return null}return n=be(n),t&&t[ee]?t.O(e,n,ut(r)?!!r.capture:!!r,i):he(t,e,n,!0,r,i)}function pe(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pe(t,e[o],n,r,i);else r=ut(r)?!!r.capture:!!r,n=be(n),t&&t[ee]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=ae(o=t.g[e],n,r,i))&&(ie(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=ge(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ae(e,n,r,i)),(n=-1<t?e[t]:null)&&de(n))}function de(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ee])se(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ye(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ge(e))?(se(n,t),0==n.h&&(n.src=null,e[ue]=null)):ie(t)}}}function ye(t){return t in ce?ce[t]:ce[t]="on"+t}function ve(t,e){if(t.ca)t=!0;else{e=new Zt(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&de(t),t=n.call(r,e)}return t}function ge(t){return(t=t[ue])instanceof oe?t:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(t){return"function"==typeof t?t:(t[me]||(t[me]=function(e){return t.handleEvent(e)}),t[me])}function we(){vt.call(this),this.i=new oe(this),this.P=this,this.I=null}function _e(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Jt(e,t);else if(e instanceof Jt)e.target=e.target||t;else{var i=e;kt(e=new Jt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Ee(s,r,!0,e)&&i}if(i=Ee(s=e.g=t,r,!0,e)&&i,i=Ee(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ee(s=e.g=n[o],r,!1,e)&&i}function Ee(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&se(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}yt(we,vt),we.prototype[ee]=!0,we.prototype.removeEventListener=function(t,e,n,r){pe(this,t,e,n,r)},we.prototype.M=function(){if(we.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ie(n[r]);delete e.g[t],e.h--}}this.I=null},we.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},we.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Te=ot.JSON.stringify;function Ie(){var t=ke,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Se,Oe=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Ae.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Ae=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Ce}),(function(t){return t.reset()})),Ce=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Ne(t){ot.setTimeout((function(){throw t}),0)}function De(t,e){Se||function(){var t=ot.Promise.resolve(void 0);Se=function(){t.then(Pe)}}(),xe||(Se(),xe=!0),ke.add(t,e)}var xe=!1,ke=new Oe;function Pe(){for(var t;t=Ie();){try{t.h.call(t.g)}catch(t){Ne(t)}var e=Ae;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}xe=!1}function Re(t,e){we.call(this),this.h=t||1,this.g=e||ot,this.j=pt(this.kb,this),this.l=Date.now()}function Le(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Me(t,e,n){if("function"==typeof t)n&&(t=pt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=pt(t.handleEvent,t)}return 2147483647<Number(e)?-1:ot.setTimeout(t,e||0)}function je(t){t.g=Me((function(){t.g=null,t.i&&(t.i=!1,je(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}yt(Re,we),(nt=Re.prototype).da=!1,nt.S=null,nt.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),_e(this,"tick"),this.da&&(Le(this),this.start()))}},nt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},nt.M=function(){Re.Z.M.call(this),Le(this),delete this.g};var Fe=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}tt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:je(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(ot.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(vt);function Ve(t){vt.call(this),this.h=t,this.g={}}yt(Ve,vt);var Ue=[];function Be(t,e,n,r){Array.isArray(n)||(n&&(Ue[0]=n.toString()),n=Ue);for(var i=0;i<n.length;i++){var o=le(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function qe(t){Nt(t.g,(function(t,e){this.g.hasOwnProperty(e)&&de(t)}),t),t.g={}}function Ge(){this.g=!0}function ze(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Te(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Ve.prototype.M=function(){Ve.Z.M.call(this),qe(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ge.prototype.Aa=function(){this.g=!1},Ge.prototype.info=function(){};var Ke={},He=null;function Xe(){return He=He||new we}function Qe(t){Jt.call(this,Ke.Ma,t)}function We(t){var e=Xe();_e(e,new Qe(e,t))}function $e(t,e){Jt.call(this,Ke.STAT_EVENT,t),this.stat=e}function Ye(t){var e=Xe();_e(e,new $e(e,t))}function Je(t,e){Jt.call(this,Ke.Na,t),this.size=e}function Ze(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ot.setTimeout((function(){t()}),e)}Ke.Ma="serverreachability",yt(Qe,Jt),Ke.STAT_EVENT="statevent",yt($e,Jt),Ke.Na="timingevent",yt(Je,Jt);var tn={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},en={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function nn(){}function rn(t){return t.h||(t.h=t.i())}function on(){}nn.prototype.h=null;var sn,an={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function un(){Jt.call(this,"d")}function cn(){Jt.call(this,"c")}function ln(){}function hn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Ve(this),this.P=pn,t=Vt?125:void 0,this.W=new Re(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new fn}function fn(){this.i=null,this.g="",this.h=!1}yt(un,Jt),yt(cn,Jt),yt(ln,nn),ln.prototype.g=function(){return new XMLHttpRequest},ln.prototype.i=function(){return{}},sn=new ln;var pn=45e3,dn={},yn={};function vn(t,e,n){t.K=1,t.v=Vn(Pn(e)),t.s=n,t.U=!0,gn(t,null)}function gn(t,e){t.F=Date.now(),_n(t),t.A=Pn(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Jn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new fn,t.g=Zr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Fe(pt(t.Ia,t,t.g),t.O)),Be(t.V,t.g,"readystatechange",t.gb),e=t.H?Dt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),We(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function mn(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function bn(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=wn(t,n))==yn){4==e&&(t.o=4,Ye(14),i=!1),ze(t.j,t.m,null,"[Incomplete Response]");break}if(r==dn){t.o=4,Ye(15),ze(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}ze(t.j,t.m,r,null),On(t,r)}mn(t)&&r!=yn&&r!=dn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ye(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Kr(e),e.L=!0,Ye(11))):(ze(t.j,t.m,n,"[Invalid Chunked Response]"),Sn(t),In(t))}function wn(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?yn:(n=Number(e.substring(n,r)),isNaN(n)?dn:(r+=1)+n>e.length?yn:(e=e.substr(r,n),t.C=r+n,e))}function _n(t){t.Y=Date.now()+t.P,En(t,t.P)}function En(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ze(pt(t.eb,t),e)}function Tn(t){t.B&&(ot.clearTimeout(t.B),t.B=null)}function In(t){0==t.l.G||t.I||Qr(t.l,t)}function Sn(t){Tn(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Le(t.W),qe(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function On(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||or(n.i,t)))if(n.I=t.N,!t.J&&or(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Xr(n),Mr(n)}zr(n),Ye(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ze(pt(n.ab,n),6e3));if(1>=ir(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else $r(n,11)}else if((t.J||n.g==t)&&Xr(n),!Et(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(St(l,"spdy")||St(l,"quic")||St(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(sr(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Fn(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=Jr(r,r.H?r.la:null,r.W),p.J){ar(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Tn(d),_n(d)),r.g=p}else Gr(r);0<n.l.length&&Vr(n)}else"stop"!=o[0]&&"close"!=o[0]||$r(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?$r(n,7):Lr(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}We(4)}catch(o){}}function An(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(at(t)||"string"==typeof t)bt(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(at(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(at(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Cn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Cn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Nn(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Dn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Dn(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(nt=hn.prototype).setTimeout=function(t){this.P=t},nt.gb=function(t){t=t.target;var e=this.L;e&&3==Dr(t)?e.l():this.Ia(t)},nt.Ia=function(t){try{if(t==this.g)t:{var e=Dr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Vt||this.g&&(this.h.h||this.g.ga()||xr(this.g)))){this.I||4!=e||7==n||We(8==n||0>=r?3:2),Tn(this);var i=this.g.ba();this.N=i;e:if(mn(this)){var o=xr(this.g);t="";var s=o.length,a=4==Dr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Sn(this),In(this);var u="";break e}this.h.i=new ot.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Et(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,Ye(12),Sn(this),In(this);break t}ze(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,On(this,i)}this.U?(bn(this,e,u),Vt&&this.i&&3==e&&(Be(this.V,this.W,"tick",this.fb),this.W.start())):(ze(this.j,this.m,u,null),On(this,u)),4==e&&Sn(this),this.i&&!this.I&&(4==e?Qr(this.l,this):(this.i=!1,_n(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Ye(12)):(this.o=0,Ye(13)),Sn(this),In(this)}}}catch(e){}},nt.fb=function(){if(this.g){var t=Dr(this.g),e=this.g.ga();this.C<e.length&&(Tn(this),bn(this,t,e),this.i&&4!=t&&_n(this))}},nt.cancel=function(){this.I=!0,Sn(this)},nt.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(We(3),Ye(17)),Sn(this),this.o=2,In(this)):En(this,this.Y-t)},(nt=Cn.prototype).R=function(){Nn(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},nt.T=function(){return Nn(this),this.g.concat()},nt.get=function(t,e){return Dn(this.h,t)?this.h[t]:e},nt.set=function(t,e){Dn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},nt.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function kn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof kn){this.g=void 0!==e?e:t.g,Rn(this,t.j),this.s=t.s,Ln(this,t.i),Mn(this,t.m),this.l=t.l,e=t.h;var n=new Qn;n.i=e.i,e.g&&(n.g=new Cn(e.g),n.h=e.h),jn(this,n),this.o=t.o}else t&&(n=String(t).match(xn))?(this.g=!!e,Rn(this,n[1]||"",!0),this.s=Un(n[2]||""),Ln(this,n[3]||"",!0),Mn(this,n[4]),this.l=Un(n[5]||"",!0),jn(this,n[6]||"",!0),this.o=Un(n[7]||"")):(this.g=!!e,this.h=new Qn(null,this.g))}function Pn(t){return new kn(t)}function Rn(t,e,n){t.j=n?Un(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ln(t,e,n){t.i=n?Un(e,!0):e}function Mn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function jn(t,e,n){e instanceof Qn?(t.h=e,function(t,e){e&&!t.j&&(Wn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&($n(this,e),Jn(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Bn(e,Hn)),t.h=new Qn(e,t.g))}function Fn(t,e,n){t.h.set(e,n)}function Vn(t){return Fn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,qn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}kn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Bn(e,Gn,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Bn(e,Gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?Kn:zn,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Bn(n,Xn)),t.join("")};var Gn=/[#\/\?@]/g,zn=/[#\?:]/g,Kn=/[#\?]/g,Hn=/[#\?@]/g,Xn=/#/g;function Qn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Wn(t){t.g||(t.g=new Cn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $n(t,e){Wn(t),e=Zn(t,e),Dn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Dn((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Nn(t)))}function Yn(t,e){return Wn(t),e=Zn(t,e),Dn(t.g.h,e)}function Jn(t,e,n){$n(t,e),0<n.length&&(t.i=null,t.g.set(Zn(t,e),_t(n)),t.h+=n.length)}function Zn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(nt=Qn.prototype).add=function(t,e){Wn(this),this.i=null,t=Zn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},nt.forEach=function(t,e){Wn(this),this.g.forEach((function(n,r){bt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},nt.T=function(){Wn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},nt.R=function(t){Wn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=wt(e,this.g.get(Zn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=wt(e,t[n])}return e},nt.set=function(t,e){return Wn(this),this.i=null,Yn(this,t=Zn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},nt.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},nt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var tr=function(t,e){this.h=t,this.g=e};function er(t){this.l=t||nr,ot.PerformanceNavigationTiming?t=0<(t=ot.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(ot.g&&ot.g.Ea&&ot.g.Ea()&&ot.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var nr=10;function rr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ir(t){return t.h?1:t.g?t.g.size:0}function or(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function sr(t,e){t.g?t.g.add(e):t.h=e}function ar(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ur(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=et(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return _t(t.i)}function cr(){}function lr(){this.g=new cr}function hr(t,e,n){var r=n||"";try{An(t,(function(t,n){var i=t;ut(t)&&(i=Te(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function fr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function pr(t){this.l=t.$b||null,this.j=t.ib||!1}function dr(t,e){we.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=yr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}er.prototype.cancel=function(){var t,e;if(this.i=ur(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=et(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},cr.prototype.stringify=function(t){return ot.JSON.stringify(t,void 0)},cr.prototype.parse=function(t){return ot.JSON.parse(t,void 0)},yt(pr,nn),pr.prototype.g=function(){return new dr(this.l,this.j)},pr.prototype.i=function(t){return function(){return t}}({}),yt(dr,we);var yr=0;function vr(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function gr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,mr(t)}function mr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(nt=dr.prototype).open=function(t,e){if(this.readyState!=yr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,mr(this)},nt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ot).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},nt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,gr(this)),this.readyState=yr},nt.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,mr(this)),this.g&&(this.readyState=3,mr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==ot.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vr(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},nt.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?gr(this):mr(this),3==this.readyState&&vr(this)}},nt.Ua=function(t){this.g&&(this.response=this.responseText=t,gr(this))},nt.Ta=function(t){this.g&&(this.response=t,gr(this))},nt.ha=function(){this.g&&gr(this)},nt.setRequestHeader=function(t,e){this.v.append(t,e)},nt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},nt.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(dr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var br=ot.JSON.parse;function wr(t){we.call(this),this.headers=new Cn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=_r,this.K=this.L=!1}yt(wr,we);var _r="",Er=/^https?$/i,Tr=["POST","PUT"];function Ir(t){return"content-type"==t.toLowerCase()}function Sr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Or(t),Cr(t)}function Or(t){t.D||(t.D=!0,_e(t,"complete"),_e(t,"error"))}function Ar(t){if(t.h&&void 0!==it&&(!t.C[1]||4!=Dr(t)||2!=t.ba()))if(t.v&&4==Dr(t))Me(t.Fa,0,t);else if(_e(t,"readystatechange"),4==Dr(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(xn)[1]||null;if(!o&&ot.self&&ot.self.location){var s=ot.self.location.protocol;o=s.substr(0,s.length-1)}i=!Er.test(o?o.toLowerCase():"")}e=i}if(e)_e(t,"complete"),_e(t,"success");else{t.m=6;try{var a=2<Dr(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Or(t)}}finally{Cr(t)}}}function Cr(t,e){if(t.g){Nr(t);var n=t.g,r=t.C[0]?st:null;t.g=null,t.C=null,e||_e(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Nr(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ot.clearTimeout(t.A),t.A=null)}function Dr(t){return t.g?t.g.readyState:0}function xr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case _r:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function kr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Nt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Fn(t,e,n))}function Pr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Rr(t){this.za=0,this.l=[],this.h=new Ge,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Pr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Pr("baseRetryDelayMs",5e3,t),this.$a=Pr("retryDelaySeedMs",1e4,t),this.Ya=Pr("forwardChannelMaxRetries",2,t),this.ra=Pr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new er(t&&t.concurrentRequestLimit),this.Ca=new lr,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Lr(t){if(jr(t),3==t.G){var e=t.V++,n=Pn(t.F);Fn(n,"SID",t.J),Fn(n,"RID",e),Fn(n,"TYPE","terminate"),Br(t,n),(e=new hn(t,t.h,e,void 0)).K=2,e.v=Vn(Pn(n)),n=!1,ot.navigator&&ot.navigator.sendBeacon&&(n=ot.navigator.sendBeacon(e.v.toString(),"")),!n&&ot.Image&&((new Image).src=e.v,n=!0),n||(e.g=Zr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),_n(e)}Yr(t)}function Mr(t){t.g&&(Kr(t),t.g.cancel(),t.g=null)}function jr(t){Mr(t),t.u&&(ot.clearTimeout(t.u),t.u=null),Xr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&ot.clearTimeout(t.m),t.m=null)}function Fr(t,e){t.l.push(new tr(t.Za++,e)),3==t.G&&Vr(t)}function Vr(t){rr(t.i)||t.m||(t.m=!0,De(t.Ha,t),t.C=0)}function Ur(t,e){var n;n=e?e.m:t.V++;var r=Pn(t.F);Fn(r,"SID",t.J),Fn(r,"RID",n),Fn(r,"AID",t.U),Br(t,r),t.o&&t.s&&kr(r,t.o,t.s),n=new hn(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=qr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),sr(t.i,n),vn(n,r,e)}function Br(t,e){t.j&&An({},(function(t,n){Fn(e,n,t)}))}function qr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?pt(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{hr(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Gr(t){t.g||t.u||(t.Y=1,De(t.Ga,t),t.A=0)}function zr(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Ze(pt(t.Ga,t),Wr(t,t.A)),t.A++,!0)}function Kr(t){null!=t.B&&(ot.clearTimeout(t.B),t.B=null)}function Hr(t){t.g=new hn(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Pn(t.oa);Fn(e,"RID","rpc"),Fn(e,"SID",t.J),Fn(e,"CI",t.N?"0":"1"),Fn(e,"AID",t.U),Br(t,e),Fn(e,"TYPE","xmlhttp"),t.o&&t.s&&kr(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Vn(Pn(e)),n.s=null,n.U=!0,gn(n,t)}function Xr(t){null!=t.v&&(ot.clearTimeout(t.v),t.v=null)}function Qr(t,e){var n=null;if(t.g==e){Xr(t),Kr(t),t.g=null;var r=2}else{if(!or(t.i,e))return;n=e.D,ar(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;_e(r=Xe(),new Je(r,n,e,i)),Vr(t)}else Gr(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ir(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Ze(pt(t.Ha,t,e),Wr(t,t.C)),t.C++,0)))}(t,e)||2==r&&zr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:$r(t,5);break;case 4:$r(t,10);break;case 3:$r(t,6);break;default:$r(t,2)}}function Wr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function $r(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=pt(t.jb,t);n||(n=new kn("//www.google.com/images/cleardot.gif"),ot.location&&"http"==ot.location.protocol||Rn(n,"https"),Vn(n)),function(t,e){var n=new Ge;if(ot.Image){var r=new Image;r.onload=dt(fr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=dt(fr,n,r,"TestLoadImage: error",!1,e),r.onabort=dt(fr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=dt(fr,n,r,"TestLoadImage: timeout",!1,e),ot.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ye(2);t.G=0,t.j&&t.j.va(e),Yr(t),jr(t)}function Yr(t){t.G=0,t.I=-1,t.j&&(0==ur(t.i).length&&0==t.l.length||(t.i.i.length=0,_t(t.l),t.l.length=0),t.j.ua())}function Jr(t,e,n){var r=function(t){return t instanceof kn?Pn(t):new kn(t,void 0)}(n);if(""!=r.i)e&&Ln(r,e+"."+r.i),Mn(r,r.m);else{var i=ot.location;r=function(t,e,n,r){var i=new kn(null,void 0);return t&&Rn(i,t),e&&Ln(i,e),n&&Mn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Nt(t.aa,(function(t,e){Fn(r,e,t)})),e=t.D,n=t.sa,e&&n&&Fn(r,e,n),Fn(r,"VER",t.ma),Br(t,r),r}function Zr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new wr(new pr({ib:!0})):new wr(t.qa)).L=t.H,e}function ti(){}function ei(){if(jt&&!(10<=Number($t)))throw Error("Environmental error: no available transport.")}function ni(t,e){we.call(this),this.g=new Rr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Et(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Et(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new oi(this)}function ri(t){un.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ii(){cn.call(this),this.status=1}function oi(t){this.g=t}(nt=wr.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():sn.g(),this.C=this.u?rn(this.u):rn(sn),this.g.onreadystatechange=pt(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Sr(this,t)}t=n||"";var i=new Cn(this.headers);r&&An(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Ir,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=ot.FormData&&t instanceof ot.FormData,!(0<=mt(Tr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Nr(this),0<this.B&&((this.K=function(t){return jt&&Qt()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=pt(this.pa,this)):this.A=Me(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Sr(this,t)}},nt.pa=function(){void 0!==it&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_e(this,"timeout"),this.abort(8))},nt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,_e(this,"complete"),_e(this,"abort"),Cr(this))},nt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Cr(this,!0)),wr.Z.M.call(this)},nt.Fa=function(){this.s||(this.F||this.v||this.l?Ar(this):this.cb())},nt.cb=function(){Ar(this)},nt.ba=function(){try{return 2<Dr(this)?this.g.status:-1}catch(t){return-1}},nt.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},nt.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),br(e)}},nt.Da=function(){return this.m},nt.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(nt=Rr.prototype).ma=8,nt.G=1,nt.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},nt.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new hn(this,this.h,t,void 0),n=this.s;if(this.P&&(n?kt(n=Dt(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=qr(this,e,r),Fn(i=Pn(this.F),"RID",t),Fn(i,"CVER",22),this.D&&Fn(i,"X-HTTP-Session-Id",this.D),Br(this,i),this.o&&n&&kr(i,this.o,n),sr(this.i,e),this.Ra&&Fn(i,"TYPE","init"),this.ja?(Fn(i,"$req",r),Fn(i,"SID","null"),e.$=!0,vn(e,i,null)):vn(e,i,r),this.G=2}}else 3==this.G&&(t?Ur(this,t):0==this.l.length||rr(this.i)||Ur(this))},nt.Ga=function(){if(this.u=null,Hr(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ze(pt(this.bb,this),t)}},nt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ye(10),Mr(this),Hr(this))},nt.ab=function(){null!=this.v&&(this.v=null,Mr(this),zr(this),Ye(19))},nt.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ye(2)):(this.h.info("Failed to ping google.com"),Ye(1))},(nt=ti.prototype).xa=function(){},nt.wa=function(){},nt.va=function(){},nt.ua=function(){},nt.Oa=function(){},ei.prototype.g=function(t,e){return new ni(t,e)},yt(ni,we),ni.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),De(pt(t.hb,t,e))),Ye(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Jr(t,null,t.W),Vr(t)},ni.prototype.close=function(){Lr(this.g)},ni.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,Fr(this.g,e)}else this.v?((e={}).__data__=Te(t),Fr(this.g,e)):Fr(this.g,t)},ni.prototype.M=function(){this.g.j=null,delete this.j,Lr(this.g),delete this.g,ni.Z.M.call(this)},yt(ri,un),yt(ii,cn),yt(oi,ti),oi.prototype.xa=function(){_e(this.g,"a")},oi.prototype.wa=function(t){_e(this.g,new ri(t))},oi.prototype.va=function(t){_e(this.g,new ii(t))},oi.prototype.ua=function(){_e(this.g,"b")},ei.prototype.createWebChannel=ei.prototype.g,ni.prototype.send=ni.prototype.u,ni.prototype.open=ni.prototype.m,ni.prototype.close=ni.prototype.close,tn.NO_ERROR=0,tn.TIMEOUT=8,tn.HTTP_ERROR=6,en.COMPLETE="complete",on.EventType=an,an.OPEN="a",an.CLOSE="b",an.ERROR="c",an.MESSAGE="d",we.prototype.listen=we.prototype.N,wr.prototype.listenOnce=wr.prototype.O,wr.prototype.getLastError=wr.prototype.La,wr.prototype.getLastErrorCode=wr.prototype.Da,wr.prototype.getStatus=wr.prototype.ba,wr.prototype.getResponseJson=wr.prototype.Qa,wr.prototype.getResponseText=wr.prototype.ga,wr.prototype.send=wr.prototype.ea;var si=tn,ai=en,ui=Ke,ci=10,li=11,hi=pr,fi=on,pi=wr,di=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();di.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var yi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},vi=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return e(n,t),n}(Error),gi=new j("@firebase/firestore");function mi(){return gi.logLevel}function bi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(gi.logLevel<=D.DEBUG){var r=e.map(Ei);gi.debug.apply(gi,a(["Firestore (8.10.0): "+t],r))}}function wi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(gi.logLevel<=D.ERROR){var r=e.map(Ei);gi.error.apply(gi,a(["Firestore (8.10.0): "+t],r))}}function _i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(gi.logLevel<=D.WARN){var r=e.map(Ei);gi.warn.apply(gi,a(["Firestore (8.10.0): "+t],r))}}function Ei(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ti(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+t;throw wi(e),new Error(e)}function Ii(t,e){t||Ti()}function Si(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ai=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Oi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Ci(t,e){return t<e?-1:t>e?1:0}function Ni(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Di(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new vi(yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new vi(yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new vi(yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new vi(yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Ci(this.nanoseconds,t.nanoseconds):Ci(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ki=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new xi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ri(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Li(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ti(),void 0===n?n=t.length-e:n>t.length-e&&Ti(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ji=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.construct=function(t,e,r){return new n(t,e,r)},n.prototype.canonicalString=function(){return this.toArray().join("/")},n.prototype.toString=function(){return this.canonicalString()},n.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new vi(yi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new n(r)},n.emptyPath=function(){return new n([])},n}(Mi),Fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Vi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.construct=function(t,e,r){return new n(t,e,r)},n.isValidIdentifier=function(t){return Fi.test(t)},n.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},n.prototype.toString=function(){return this.canonicalString()},n.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},n.keyField=function(){return new n(["__name__"])},n.fromServerFormat=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new vi(yi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new vi(yi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new vi(yi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new vi(yi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.emptyPath=function(){return new n([])},n}(Mi),Ui=function(){function t(t){this.fields=t,t.sort(Vi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Ni(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Bi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Ci(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Bi.EMPTY_BYTE_STRING=new Bi("");var qi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gi(t){if(Ii(!!t),"string"==typeof t){var e=0,n=qi.exec(t);if(Ii(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:zi(t.seconds),nanos:zi(t.nanos)}}function zi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ki(t){return"string"==typeof t?Bi.fromBase64String(t):Bi.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Xi(t){var e=t.mapValue.fields.__previous_value__;return Hi(e)?Xi(e):e}function Qi(t){var e=Gi(t.mapValue.fields.__local_write_time__.timestampValue);return new xi(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wi(t){return null==t}function $i(t){return 0===t&&1/t==-1/0}function Yi(t){return"number"==typeof t&&Number.isInteger(t)&&!$i(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ji=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ji.fromString(e))},t.fromName=function(e){return new t(ji.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ji.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ji.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ji(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Hi(t)?4:10:Ti()}function to(t,e){var n=Zi(t);if(n!==Zi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qi(t).isEqual(Qi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Gi(t.timestampValue),r=Gi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ki(t.bytesValue).isEqual(Ki(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return zi(t.geoPointValue.latitude)===zi(e.geoPointValue.latitude)&&zi(t.geoPointValue.longitude)===zi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return zi(t.integerValue)===zi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=zi(t.doubleValue),r=zi(e.doubleValue);return n===r?$i(n)===$i(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ni(t.arrayValue.values||[],e.arrayValue.values||[],to);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Pi(n)!==Pi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!to(n[i],r[i])))return!1;return!0}(t,e);default:return Ti()}}function eo(t,e){return void 0!==(t.values||[]).find((function(t){return to(t,e)}))}function no(t,e){var n=Zi(t),r=Zi(e);if(n!==r)return Ci(n,r);switch(n){case 0:return 0;case 1:return Ci(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=zi(t.integerValue||t.doubleValue),r=zi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ro(t.timestampValue,e.timestampValue);case 4:return ro(Qi(t),Qi(e));case 5:return Ci(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ki(t),r=Ki(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ci(n[i],r[i]);if(0!==o)return o}return Ci(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ci(zi(t.latitude),zi(e.latitude));return 0!==n?n:Ci(zi(t.longitude),zi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=no(n[i],r[i]);if(o)return o}return Ci(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ci(r[s],o[s]);if(0!==a)return a;var u=no(n[r[s]],i[o[s]]);if(0!==u)return u}return Ci(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ti()}}function ro(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ci(t,e);var n=Gi(t),r=Gi(e),i=Ci(n.seconds,r.seconds);return 0!==i?i:Ci(n.nanos,r.nanos)}function io(t){return oo(t)}function oo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Gi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ki(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ji.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=oo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+oo(t.fields[o])}return e+"}"}(t.mapValue):Ti();var e,n}function so(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ao(t){return!!t&&"integerValue"in t}function uo(t){return!!t&&"arrayValue"in t}function co(t){return!!t&&"nullValue"in t}function lo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ho(t){return!!t&&"mapValue"in t}function fo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Ri(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=fo(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=fo(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var po=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!ho(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=fo(e)},t.prototype.setAll=function(t){var e=this,n=Vi.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=fo(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());ho(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return to(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];ho(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Ri(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(fo(this.value))},t}();function yo(t){var e=[];return Ri(t.fields,(function(t,n){var r=new Vi([t]);if(ho(n)){var i=yo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Ui(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var vo=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,ki.min(),po.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,po.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,po.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=po.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=po.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),go=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function mo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new go(t,e,n,r,i,o,s)}function bo(t){var e=Si(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+io(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Wi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ko(e.startAt)),e.endAt&&(n+="|ub:",n+=ko(e.endAt)),e.h=n}return e.h}function wo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ro(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!to(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mo(t.startAt,e.startAt)&&Mo(t.endAt,e.endAt)}function _o(t){return Ji.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Eo=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return e(n,t),n.create=function(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,r):new To(t,e,r):"array-contains"===e?new Ao(t,r):"in"===e?new Co(t,r):"not-in"===e?new No(t,r):"array-contains-any"===e?new Do(t,r):new n(t,e,r)},n.l=function(t,e,n){return"in"===e?new Io(t,n):new So(t,n)},n.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(no(e,this.value)):null!==e&&Zi(this.value)===Zi(e)&&this.m(no(e,this.value))},n.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ti()}},n.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}((function(){})),To=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ji.fromName(r.referenceValue),i}return e(n,t),n.prototype.matches=function(t){var e=Ji.comparator(t.key,this.key);return this.m(e)},n}(Eo),Io=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Oo("in",n),r}return e(n,t),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Eo),So=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Oo("not-in",n),r}return e(n,t),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Eo);function Oo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ji.fromName(t.referenceValue)}))}var Ao=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.data.field(this.field);return uo(e)&&eo(e.arrayValue,this.value)},n}(Eo),Co=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&eo(this.value.arrayValue,e)},n}(Eo),No=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return e(n,t),n.prototype.matches=function(t){if(eo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!eo(this.value.arrayValue,e)},n}(Eo),Do=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return e(n,t),n.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!uo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return eo(e.value.arrayValue,t)}))},n}(Eo),xo=function(t,e){this.position=t,this.before=e};function ko(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return io(t)})).join(",")}var Po=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ro(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Lo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ji.comparator(Ji.fromName(s.referenceValue),n.key):no(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Mo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!to(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Fo(t,e,n,r,i,o,s,a){return new jo(t,e,n,r,i,o,s,a)}function Vo(t){return new jo(t)}function Uo(t){return!Wi(t.limit)&&"F"===t.limitType}function Bo(t){return!Wi(t.limit)&&"L"===t.limitType}function qo(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Go(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function zo(t){return null!==t.collectionGroup}function Ko(t){var e=Si(t);if(null===e.p){e.p=[];var n=Go(e),r=qo(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Po(n)),e.p.push(new Po(Vi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Po(Vi.keyField(),u))}}}return e.p}function Ho(t){var e=Si(t);if(!e.T)if("F"===e.limitType)e.T=mo(e.path,e.collectionGroup,Ko(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ko(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Po(o.field,s))}var a=e.endAt?new xo(e.endAt.position,!e.endAt.before):null,u=e.startAt?new xo(e.startAt.position,!e.startAt.before):null;e.T=mo(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Xo(t,e,n){return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qo(t,e){return wo(Ho(t),Ho(e))&&t.limitType===e.limitType}function Wo(t){return bo(Ho(t))+"|lt:"+t.limitType}function $o(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+io(e.value);var e})).join(", ")+"]"),Wi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ko(t.startAt)),t.endAt&&(e+=", endAt: "+ko(t.endAt)),"Target("+e+")"}(Ho(t))+"; limitType="+t.limitType+")"}function Yo(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ji.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Lo(t.startAt,Ko(t),e)||t.endAt&&Lo(t.endAt,Ko(t),e))}(t,e)}function Jo(t){return function(e,n){for(var r=!1,i=0,o=Ko(t);i<o.length;i++){var s=o[i],a=Zo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Zo(t,e,n){var r=t.field.isKeyField()?Ji.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?no(r,i):Ti()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ti()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ts(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$i(e)?"-0":e}}function es(t){return{integerValue:""+t}}function ns(t,e){return Yi(e)?es(e):ts(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rs=function(){this._=void 0};function is(t,e,n){return t instanceof as?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof us?cs(t,e):t instanceof ls?hs(t,e):function(t,e){var n=ss(t,e),r=ps(n)+ps(t.A);return ao(n)&&ao(t.A)?es(r):ts(t.R,r)}(t,e)}function os(t,e,n){return t instanceof us?cs(t,e):t instanceof ls?hs(t,e):n}function ss(t,e){return t instanceof fs?ao(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var as=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(rs),us=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(rs);function cs(t,e){for(var n=ds(e),r=function(t){n.some((function(e){return to(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ls=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(rs);function hs(t,e){for(var n=ds(e),r=function(t){n=n.filter((function(e){return!to(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var fs=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return e(n,t),n}(rs);function ps(t){return zi(t.integerValue||t.doubleValue)}function ds(t){return uo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ys=function(t,e){this.field=t,this.transform=e},vs=function(t,e){this.version=t,this.transformResults=e},gs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ms(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var bs=function(){};function ws(t,e,n){t instanceof Ss?function(t,e,n){var r=t.value.clone(),i=Cs(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Os?function(t,e,n){if(ms(t.precondition,e)){var r=Cs(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(As(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function _s(t,e,n){t instanceof Ss?function(t,e,n){if(ms(t.precondition,e)){var r=t.value.clone(),i=Ns(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Is(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Os?function(t,e,n){if(ms(t.precondition,e)){var r=Ns(t.fieldTransforms,n,e),i=e.data;i.setAll(As(t)),i.setAll(r),e.convertToFoundDocument(Is(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){ms(t.precondition,e)&&e.convertToNoDocument(ki.min())}(t,e)}function Es(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=ss(o.transform,s||null);null!=a&&(null==n&&(n=po.empty()),n.set(o.field,a))}return n||null}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ni(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof us&&e instanceof us||t instanceof ls&&e instanceof ls?Ni(t.elements,e.elements,to):t instanceof fs&&e instanceof fs?to(t.A,e.A):t instanceof as&&e instanceof as}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Is(t){return t.isFoundDocument()?t.version:ki.min()}var Ss=function(t){function n(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return e(n,t),n}(bs),Os=function(t){function n(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return e(n,t),n}(bs);function As(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Cs(t,e,n){var r=new Map;Ii(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,os(s,a,n[i]))}return r}function Ns(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,is(a,u,e))}return r}var Ds,xs,ks=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return e(n,t),n}(bs),Ps=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return e(n,t),n}(bs),Rs=function(t){this.count=t};function Ls(t){switch(t){case yi.OK:return Ti();case yi.CANCELLED:case yi.UNKNOWN:case yi.DEADLINE_EXCEEDED:case yi.RESOURCE_EXHAUSTED:case yi.INTERNAL:case yi.UNAVAILABLE:case yi.UNAUTHENTICATED:return!1;case yi.INVALID_ARGUMENT:case yi.NOT_FOUND:case yi.ALREADY_EXISTS:case yi.PERMISSION_DENIED:case yi.FAILED_PRECONDITION:case yi.ABORTED:case yi.OUT_OF_RANGE:case yi.UNIMPLEMENTED:case yi.DATA_LOSS:return!0;default:return Ti()}}function Ms(t){if(void 0===t)return wi("GRPC error has no .code"),yi.UNKNOWN;switch(t){case Ds.OK:return yi.OK;case Ds.CANCELLED:return yi.CANCELLED;case Ds.UNKNOWN:return yi.UNKNOWN;case Ds.DEADLINE_EXCEEDED:return yi.DEADLINE_EXCEEDED;case Ds.RESOURCE_EXHAUSTED:return yi.RESOURCE_EXHAUSTED;case Ds.INTERNAL:return yi.INTERNAL;case Ds.UNAVAILABLE:return yi.UNAVAILABLE;case Ds.UNAUTHENTICATED:return yi.UNAUTHENTICATED;case Ds.INVALID_ARGUMENT:return yi.INVALID_ARGUMENT;case Ds.NOT_FOUND:return yi.NOT_FOUND;case Ds.ALREADY_EXISTS:return yi.ALREADY_EXISTS;case Ds.PERMISSION_DENIED:return yi.PERMISSION_DENIED;case Ds.FAILED_PRECONDITION:return yi.FAILED_PRECONDITION;case Ds.ABORTED:return yi.ABORTED;case Ds.OUT_OF_RANGE:return yi.OUT_OF_RANGE;case Ds.UNIMPLEMENTED:return yi.UNIMPLEMENTED;case Ds.DATA_LOSS:return yi.DATA_LOSS;default:return Ti()}}(xs=Ds||(Ds={}))[xs.OK=0]="OK",xs[xs.CANCELLED=1]="CANCELLED",xs[xs.UNKNOWN=2]="UNKNOWN",xs[xs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xs[xs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xs[xs.NOT_FOUND=5]="NOT_FOUND",xs[xs.ALREADY_EXISTS=6]="ALREADY_EXISTS",xs[xs.PERMISSION_DENIED=7]="PERMISSION_DENIED",xs[xs.UNAUTHENTICATED=16]="UNAUTHENTICATED",xs[xs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xs[xs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xs[xs.ABORTED=10]="ABORTED",xs[xs.OUT_OF_RANGE=11]="OUT_OF_RANGE",xs[xs.UNIMPLEMENTED=12]="UNIMPLEMENTED",xs[xs.INTERNAL=13]="INTERNAL",xs[xs.UNAVAILABLE=14]="UNAVAILABLE",xs[xs.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var js=function(){function t(t,e){this.comparator=t,this.root=e||Vs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Fs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Fs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Fs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Fs(this.root,t,this.comparator,!0)},t}(),Fs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Vs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ti();if(this.right.isRed())throw Ti();var t=this.left.check();if(t!==this.right.check())throw Ti();return t+(this.isRed()?0:1)},t}();Vs.EMPTY=null,Vs.RED=!0,Vs.BLACK=!1,Vs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ti()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Vs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Us=function(){function t(t){this.comparator=t,this.data=new js(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Bs(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Bs(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Bs=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),qs=new js(Ji.comparator);function Gs(){return qs}var zs=new js(Ji.comparator);function Ks(){return zs}var Hs=new js(Ji.comparator);var Xs=new Us(Ji.comparator);function Qs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Xs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ws=new Us(Ci);function $s(){return Ws}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ys=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Js.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(ki.min(),r,$s(),Gs(),Qs())},t}(),Js=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Bi.EMPTY_BYTE_STRING,n,Qs(),Qs(),Qs())},t}(),Zs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ta=function(t,e){this.targetId=t,this.V=e},ea=function(t,e,n,r){void 0===n&&(n=Bi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},na=function(){function t(){this.S=0,this.D=oa(),this.C=Bi.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=Qs(),e=Qs(),n=Qs();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ti()}})),new Js(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=oa()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),ra=function(){function t(t){this.W=t,this.G=new Map,this.H=Gs(),this.J=ia(),this.Y=new Us(Ci)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Ti()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(_o(i))if(0===n){var o=new Ji(i.path);this.tt(e,o,vo.newNoDocument(o,ki.min()))}else Ii(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&_o(o.target)){var s=new Ji(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,vo.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Qs();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ys(t,n,this.Y,this.H,r);return this.H=Gs(),this.J=ia(),this.Y=new Us(Ci),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new na,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Us(Ci),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||bi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new na),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ia(){return new js(Ji.comparator)}function oa(){return new js(Ji.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sa={asc:"ASCENDING",desc:"DESCENDING"},aa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ua=function(t,e){this.databaseId=t,this.I=e};function ca(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function la(t,e){return t.I?e.toBase64():e.toUint8Array()}function ha(t,e){return ca(t,e.toTimestamp())}function fa(t){return Ii(!!t),ki.fromTimestamp(function(t){var e=Gi(t);return new xi(e.seconds,e.nanos)}(t))}function pa(t,e){return function(t){return new ji(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function da(t){var e=ji.fromString(t);return Ii(ja(e)),e}function ya(t,e){return pa(t.databaseId,e.path)}function va(t,e){var n=da(e);if(n.get(1)!==t.databaseId.projectId)throw new vi(yi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new vi(yi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ji(wa(n))}function ga(t,e){return pa(t.databaseId,e)}function ma(t){var e=da(t);return 4===e.length?ji.emptyPath():wa(e)}function ba(t){return new ji(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wa(t){return Ii(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function _a(t,e,n){return{name:ya(t,e),fields:n.value.mapValue.fields}}function Ea(t,e){var n;if(e instanceof Ss)n={update:_a(t,e.key,e.value)};else if(e instanceof ks)n={delete:ya(t,e.key)};else if(e instanceof Os)n={update:_a(t,e.key,e.data),updateMask:Ma(e.fieldMask)};else{if(!(e instanceof Ps))return Ti();n={verify:ya(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof as)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof us)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ls)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof fs)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Ti()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ha(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ti()}(t,e.precondition)),n}function Ta(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?gs.updateTime(fa(t.updateTime)):void 0!==t.exists?gs.exists(t.exists):gs.none()}(e.currentDocument):gs.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Ii("REQUEST_TIME"===e.setToServerValue),n=new as;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new us(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ls(i)}else"increment"in e?n=new fs(t,e.increment):Ti();var o=Vi.fromServerFormat(e.fieldPath);return new ys(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=va(t,e.update.name),o=new po({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Ui(e.map((function(t){return Vi.fromServerFormat(t)})))}(e.updateMask);return new Os(i,o,s,n,r)}return new Ss(i,o,n,r)}if(e.delete){var a=va(t,e.delete);return new ks(a,n)}if(e.verify){var u=va(t,e.verify);return new Ps(u,n)}return Ti()}function Ia(t,e){return{documents:[ga(t,e.path)]}}function Sa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ga(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ga(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(lo(t.value))return{unaryFilter:{field:ka(t.field),op:"IS_NAN"}};if(co(t.value))return{unaryFilter:{field:ka(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(lo(t.value))return{unaryFilter:{field:ka(t.field),op:"IS_NOT_NAN"}};if(co(t.value))return{unaryFilter:{field:ka(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ka(t.field),op:xa(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:ka(t.field),direction:Da(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Wi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ca(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ca(e.endAt)),n}function Oa(t){var e=ma(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ii(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Aa(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new Po(Pa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Wi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Na(n.startAt));var l=null;return n.endAt&&(l=Na(n.endAt)),Fo(e,i,a,s,u,"F",c,l)}function Aa(t){return t?void 0!==t.unaryFilter?[La(t)]:void 0!==t.fieldFilter?[Ra(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Aa(t)})).reduce((function(t,e){return t.concat(e)})):Ti():[]}function Ca(t){return{before:t.before,values:t.position}}function Na(t){var e=!!t.before,n=t.values||[];return new xo(n,e)}function Da(t){return sa[t]}function xa(t){return aa[t]}function ka(t){return{fieldPath:t.canonicalString()}}function Pa(t){return Vi.fromServerFormat(t.fieldPath)}function Ra(t){return Eo.create(Pa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ti()}}(t.fieldFilter.op),t.fieldFilter.value)}function La(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Pa(t.unaryFilter.field);return Eo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Pa(t.unaryFilter.field);return Eo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Pa(t.unaryFilter.field);return Eo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Pa(t.unaryFilter.field);return Eo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ti()}}function Ma(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function ja(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ua(e)),e=Va(t.get(n),e);return Ua(e)}function Va(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ua(t){return t+""}function Ba(t){var e=t.length;if(Ii(e>=2),2===e)return Ii(""===t.charAt(0)&&""===t.charAt(1)),ji.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Ti(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ti()}o=s+2}return new ji(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qa=function(t,e){this.seconds=t,this.nanoseconds=e},Ga=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ga.store="owner",Ga.key="owner";var za=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};za.store="mutationQueues",za.keyPath="userId";var Ka=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ka.store="mutations",Ka.keyPath="batchId",Ka.userMutationsIndex="userMutationsIndex",Ka.userMutationsKeyPath=["userId","batchId"];var Ha=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Fa(e)]},t.key=function(t,e,n){return[t,Fa(e),n]},t}();Ha.store="documentMutations",Ha.PLACEHOLDER=new Ha;var Xa=function(t,e){this.path=t,this.readTime=e},Qa=function(t,e){this.path=t,this.version=e},Wa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Wa.store="remoteDocuments",Wa.readTimeIndex="readTimeIndex",Wa.readTimeIndexPath="readTime",Wa.collectionReadTimeIndex="collectionReadTimeIndex",Wa.collectionReadTimeIndexPath=["parentPath","readTime"];var $a=function(t){this.byteSize=t};$a.store="remoteDocumentGlobal",$a.key="remoteDocumentGlobalKey";var Ya=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ya.store="targets",Ya.keyPath="targetId",Ya.queryTargetsIndexName="queryTargetsIndex",Ya.queryTargetsKeyPath=["canonicalId","targetId"];var Ja=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ja.store="targetDocuments",Ja.keyPath=["targetId","path"],Ja.documentTargetsIndex="documentTargetsIndex",Ja.documentTargetsKeyPath=["path","targetId"];var Za=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Za.key="targetGlobalKey",Za.store="targetGlobal";var tu=function(t,e){this.collectionId=t,this.parent=e};tu.store="collectionParents",tu.keyPath=["collectionId","parent"];var eu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};eu.store="clientMetadata",eu.keyPath="clientId";var nu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};nu.store="bundles",nu.keyPath="bundleId";var ru=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ru.store="namedQueries",ru.keyPath="name";var iu=a(a([],a(a([],a(a([],a(a([],[za.store,Ka.store,Ha.store,Wa.store,Ya.store,Ga.store,Za.store,Ja.store]),[eu.store])),[$a.store])),[tu.store])),[nu.store,ru.store]),ou="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",su=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),au=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},uu=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Ti(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),cu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new au,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new fu(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=gu(e.target.error);n.ft.reject(new fu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new fu(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(bi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new du(e)},t}(),lu=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(p())&&wi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return bi("SimpleDb","Removing database:",t),yu(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=p(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(bi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new fu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new vi(yi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new fu(t,n))},i.onupgradeneeded=function(t){bi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){bi("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a,u,c;return i(this,(function(l){switch(l.label){case 0:r="readonly"===e,s=0,a=function(){var e,a,c,l,h;return i(this,(function(i){switch(i.label){case 0:++s,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=i.sent(),e=cu.open(u.db,t,r?"readonly":"readwrite",n),a=o(e).catch((function(t){return e.abort(t),uu.reject(t)})).toPromise(),c={},a.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(i.sent(),a),c)];case 4:return l=i.sent(),h="FirebaseError"!==l.name&&s<3,bi("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}}))},u=this,l.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=l.sent()))return[2,c.value];l.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),hu=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return yu(this.Pt.delete())},t}(),fu=function(t){function n(e,n){var r=this;return(r=t.call(this,yi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return e(n,t),n}(vi);function pu(t){return"IndexedDbTransactionError"===t.name}var du=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(bi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(bi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),yu(n)},t.prototype.add=function(t){return bi("SimpleDb","ADD",this.store.name,t,t),yu(this.store.add(t))},t.prototype.get=function(t){var e=this;return yu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),bi("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return bi("SimpleDb","DELETE",this.store.name,t),yu(this.store.delete(t))},t.prototype.count=function(){return bi("SimpleDb","COUNT",this.store.name),yu(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){bi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new uu((function(n,r){e.onerror=function(t){var e=gu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new uu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new hu(i),s=e(i.primaryKey,i.value,o);if(s instanceof uu){var a=s.catch((function(t){return o.done(),uu.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return uu.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function yu(t){return new uu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=gu(t.target.error);n(e)}}))}var vu=!1;function gu(t){var e=lu._t(p());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new vi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return vu||(vu=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mu=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return e(n,t),n}(su);function bu(t,e){var n=Si(t);return lu.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&ws(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&_s(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&_s(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ki.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Qs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ni(this.mutations,t.mutations,(function(t,e){return Ts(t,e)}))&&Ni(this.baseMutations,t.baseMutations,(function(t,e){return Ts(t,e)}))},t}(),_u=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Ii(e.mutations.length===r.length);for(var i=Hs,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Eu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ki.min()),void 0===o&&(o=ki.min()),void 0===s&&(s=Bi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Tu=function(t){this.Lt=t};function Iu(t,e){if(e.document)return function(t,e,n){var r=va(t,e.name),i=fa(e.updateTime),o=new po({mapValue:{fields:e.fields}}),s=vo.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ji.fromSegments(e.noDocument.path),r=Nu(e.noDocument.readTime),i=vo.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ji.fromSegments(e.unknownDocument.path);return r=Nu(e.unknownDocument.version),vo.newUnknownDocument(o,r)}return Ti()}function Su(t,e,n){var r=Ou(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:ya(t,e.key),fields:e.data.value.mapValue.fields,updateTime:ca(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Wa(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Cu(e.version);return s=e.hasCommittedMutations,new Wa(null,new Xa(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=Cu(e.version);return new Wa(new Qa(c,l),null,null,!0,r,i)}return Ti()}function Ou(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Au(t){var e=new xi(t[0],t[1]);return ki.fromTimestamp(e)}function Cu(t){var e=t.toTimestamp();return new qa(e.seconds,e.nanoseconds)}function Nu(t){var e=new xi(t.seconds,t.nanoseconds);return ki.fromTimestamp(e)}function Du(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Ta(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Ta(t.Lt,e)})),a=xi.fromMillis(e.localWriteTimeMs);return new wu(e.batchId,a,n,s)}function xu(t){var e,n,r=Nu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Nu(t.lastLimboFreeSnapshotVersion):ki.min();return void 0!==t.query.documents?(Ii(1===(n=t.query).documents.length),e=Ho(Vo(ma(n.documents[0])))):e=function(t){return Ho(Oa(t))}(t.query),new Eu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Bi.fromBase64String(t.resumeToken))}function ku(t,e){var n,r=Cu(e.snapshotVersion),i=Cu(e.lastLimboFreeSnapshotVersion);n=_o(e.target)?Ia(t.Lt,e.target):Sa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ya(e.targetId,bo(e.target),r,o,e.sequenceNumber,i,n)}function Pu(t){var e=Oa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Xo(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ru=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Lu(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Nu(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Lu(t).put({bundleId:(n=e).id,createTime:Cu(fa(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Mu(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Pu(e.bundledQuery),readTime:Nu(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Mu(t).put(function(t){return{name:t.name,readTime:Cu(fa(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Lu(t){return bu(t,nu.store)}function Mu(t){return bu(t,ru.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ju=function(){function t(){this.Bt=new Fu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),uu.resolve()},t.prototype.getCollectionParents=function(t,e){return uu.resolve(this.Bt.getEntries(e))},t}(),Fu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Us(ji.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Us(ji.comparator)).toArray()},t}(),Vu=function(){function t(){this.qt=new Fu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Fa(i)};return Uu(t).put(o)}return uu.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Di(e),""],!1,!0);return Uu(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ba(o.parent))}return n}))},t}();function Uu(t){return bu(t,tu.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Gu(t,e,n){var r=t.store(Ka.store),i=t.store(Ha.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Ii(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=Ha.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return uu.waitFor(o).next((function(){return c}))}function zu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ti();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */qu.DEFAULT_COLLECTION_PERCENTILE=10,qu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qu.DEFAULT=new qu(41943040,qu.DEFAULT_COLLECTION_PERCENTILE,qu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qu.DISABLED=new qu(-1,0,0);var Ku=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Ii(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Xu(t).$t({index:Ka.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Qu(t),s=Xu(t);return s.add({}).next((function(a){Ii("number"==typeof a);for(var u=new wu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ea(t.Lt,e)})),i=n.mutations.map((function(e){return Ea(t.Lt,e)}));return new Ka(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Us((function(t,e){return Ci(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=Ha.key(i.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(s.put(c)),l.push(o.put(y,Ha.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),uu.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Xu(t).get(e).next((function(t){return t?(Ii(t.userId===n.userId),Du(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?uu.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Xu(t).$t({index:Ka.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Ii(e.batchId>=r),o=Du(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Xu(t).$t({index:Ka.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Xu(t).Nt(Ka.userMutationsIndex,n).next((function(t){return t.map((function(t){return Du(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ha.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Qu(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=Ba(u);if(a===n.userId&&e.path.isEqual(l))return Xu(t).get(c).next((function(t){if(!t)throw Ti();Ii(t.userId===n.userId),o.push(Du(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Us(Ci),i=[];return e.forEach((function(e){var o=Ha.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Qu(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Ba(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),uu.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ha.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Us(Ci);return Qu(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=Ba(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Xu(t).get(e).next((function(t){if(null===t)throw Ti();Ii(t.userId===n.userId),r.push(Du(n.R,t))})))})),uu.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Gu(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),uu.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return uu.resolve();var r=IDBKeyRange.lowerBound(Ha.prefixForUser(e.userId)),i=[];return Qu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ba(t[1]);i.push(o)}else r.done()})).next((function(){Ii(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Hu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Wu(t).get(this.userId).next((function(t){return t||new za(e.userId,-1,"")}))},t}();function Hu(t,e,n){var r=Ha.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Qu(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Xu(t){return bu(t,Ka.store)}function Qu(t){return bu(t,Ha.store)}function Wu(t){return bu(t,za.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $u=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Yu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new $u(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return ki.fromTimestamp(new xi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ju(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Ii(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ju(t).$t((function(s,a){var u=xu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return uu.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Ju(t).$t((function(t,n){var r=xu(n);e(r)}))},t.prototype.Xt=function(t){return Zu(t).get(Za.key).next((function(t){return Ii(null!==t),t}))},t.prototype.Zt=function(t,e){return Zu(t).put(Za.key,e)},t.prototype.te=function(t,e){return Ju(t).put(ku(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=bo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ju(t).$t({range:r,index:Ya.queryTargetsIndexName},(function(t,n,r){var o=xu(n);wo(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=tc(t);return e.forEach((function(e){var s=Fa(e.path);i.push(o.put(new Ja(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),uu.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=tc(t);return uu.forEach(e,(function(e){var o=Fa(e.path);return uu.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=tc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=tc(t),i=Qs();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=Ba(t[1]),o=new Ji(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Fa(e.path),r=IDBKeyRange.bound([n],[Di(n)],!1,!0),i=0;return tc(t).$t({index:Ja.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Ju(t).get(e).next((function(t){return t?xu(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ju(t){return bu(t,Ya.store)}function Zu(t){return bu(t,Za.store)}function tc(t){return bu(t,Ja.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ec(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(t.code!==yi.FAILED_PRECONDITION||t.message!==ou)throw t;return bi("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ci(n,i);return 0===s?Ci(r,o):s}var rc=function(){function t(t){this.ne=t,this.buffer=new Us(nc),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();nc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ic=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;bi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return pu(e=n.sent())?(bi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ec(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),oc=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return uu.resolve(di.o);var r=new rc(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(bi("LruGarbageCollector","Garbage collection skipped; disabled"),uu.resolve(Bu)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(bi("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Bu):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(bi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),mi()<=D.DEBUG&&bi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),uu.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),sc=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new oc(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return ac(t,n)},t.prototype.removeReference=function(t,e,n){return ac(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return ac(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Wu(t).Ot((function(r){return Hu(t,r,e).next((function(t){return t&&(n=!0),uu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),tc(t).delete([0,Fa(s.path)])}))}));i.push(u)}})).next((function(){return uu.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return ac(t,e)},t.prototype.we=function(t,e){var n,r=tc(t),i=di.o;return r.$t({index:Ja.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==di.o&&e(new Ji(Ba(n)),i),i=a,n=s):i=di.o})).next((function(){i!==di.o&&e(new Ji(Ba(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function ac(t,e){return tc(t).put(function(t,e){return new Ja(0,Fa(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uc=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Ri(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return Li(this.inner)},t}(),cc=function(){function t(){this.changes=new uc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:ki.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:vo.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?uu.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),lc=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return pc(t).put(dc(e),n)},t.prototype.removeEntry=function(t,e){var n=pc(t),r=dc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return pc(t).get(dc(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return pc(t).get(dc(e)).next((function(t){return{document:n.ye(e,t),size:zu(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Gs();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Gs(),i=new js(Ji.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,zu(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return uu.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return pc(t).$t({range:r},(function(t,e,r){for(var s=Ji.fromSegments(t);o&&Ji.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Gs(),o=e.path.length+1,s={};if(n.isEqual(ki.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Ou(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Wa.collectionReadTimeIndex}return pc(t).$t(s,(function(t,n,s){if(t.length===o){var a=Iu(r.R,n);e.path.isPrefixOf(a.key.path)?Yo(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new hc(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return fc(t).get($a.key).next((function(t){return Ii(!!t),t}))},t.prototype.me=function(t,e){return fc(t).put($a.key,e)},t.prototype.ye=function(t,e){if(e){var n=Iu(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(ki.min()))return n}return vo.newInvalidDocument(t)},t}(),hc=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new uc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return e(n,t),n.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Us((function(t,e){return Ci(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Su(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=zu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=Su(e.Ie.R,vo.newNoDocument(o,ki.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),uu.waitFor(n)},n.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},n.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},n}(cc);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fc(t){return bu(t,$a.store)}function pc(t){return bu(t,Wa.store)}function dc(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yc=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Ii(n<r&&n>=0&&r<=11);var o=new cu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ga.store)}(t),function(t){t.createObjectStore(za.store,{keyPath:za.keyPath}),t.createObjectStore(Ka.store,{keyPath:Ka.keyPath,autoIncrement:!0}).createIndex(Ka.userMutationsIndex,Ka.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ha.store)}(t),vc(t),function(t){t.createObjectStore(Wa.store)}(t));var s=uu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ja.store),t.deleteObjectStore(Ya.store),t.deleteObjectStore(Za.store)}(t),vc(t)),s=s.next((function(){return function(t){var e=t.store(Za.store),n=new Za(0,0,ki.min().toTimestamp(),0);return e.put(Za.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Ka.store).Nt().next((function(n){t.deleteObjectStore(Ka.store),t.createObjectStore(Ka.store,{keyPath:Ka.keyPath,autoIncrement:!0}).createIndex(Ka.userMutationsIndex,Ka.userMutationsKeyPath,{unique:!0});var r=e.store(Ka.store),i=n.map((function(t){return r.put(t)}));return uu.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(eu.store,{keyPath:eu.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore($a.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Wa.store);e.createIndex(Wa.readTimeIndex,Wa.readTimeIndexPath,{unique:!1}),e.createIndex(Wa.collectionReadTimeIndex,Wa.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(nu.store,{keyPath:nu.keyPath})}(t),function(t){t.createObjectStore(ru.store,{keyPath:ru.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Wa.store).$t((function(t,n){e+=zu(n)})).next((function(){var n=new $a(e);return t.store($a.store).put($a.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(za.store),r=t.store(Ka.store);return n.Nt().next((function(n){return uu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Ka.userMutationsIndex,i).next((function(r){return uu.forEach(r,(function(r){Ii(r.userId===n.userId);var i=Du(e.R,r);return Gu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ja.store),n=t.store(Wa.store);return t.store(Za.store).get(Za.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new ji(n),s=function(t){return[0,Fa(t)]}(o);r.push(e.get(s).next((function(n){return n?uu.resolve():function(n){return e.put(new Ja(0,Fa(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return uu.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(tu.store,{keyPath:tu.keyPath});var n=e.store(tu.store),r=new Fu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Fa(i)})}};return e.store(Wa.store).$t({Ft:!0},(function(t,e){var n=new ji(t);return i(n.popLast())})).next((function(){return e.store(Ha.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=Ba(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ya.store);return n.$t((function(t,r){var i=xu(r),o=ku(e.R,i);return n.put(o)}))},t}();function vc(t){t.createObjectStore(Ja.store,{keyPath:Ja.keyPath}).createIndex(Ja.documentTargetsIndex,Ja.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}).createIndex(Ya.queryTargetsIndexName,Ya.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Za.store)}var gc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mc=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new vi(yi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new sc(this,i),this.Le=n+"main",this.R=new Tu(u),this.Be=new lu(this.Le,11,new yc(this.R)),this.qe=new Yu(this.referenceDelegate,this.R),this.Ut=new Vu,this.Ue=function(t,e){return new lc(t,e)}(this.R,this.Ut),this.Ke=new Ru,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&wi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new vi(yi.FAILED_PRECONDITION,gc);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new di(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return wc(e).put(new eu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(pu(e))return bi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return bi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return bc(t).get(Ga.key).next((function(t){return uu.resolve(e.tn(t))}))},t.prototype.en=function(t){return wc(t).delete(this.clientId)},t.prototype.nn=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o=this;return i(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=bu(t,eu.store);return e.Nt().next((function(t){var n=o.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return uu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?uu.resolve(!0):bc(t).get(Ga.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new vi(yi.FAILED_PRECONDITION,gc);return!1}}return!(!e.networkEnabled||!e.inForeground)||wc(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&bi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ga.store,eu.store],(function(e){var n=new mu(e,di.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return wc(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Ku.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;bi("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,iu,(function(o){return i=new mu(o,r.Ne?r.Ne.next():di.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw wi("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new vi(yi.FAILED_PRECONDITION,ou);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return bc(t).get(Ga.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new vi(yi.FAILED_PRECONDITION,gc)}))},t.prototype.Ze=function(t){var e=new Ga(this.clientId,this.allowTabSynchronization,Date.now());return bc(t).put(Ga.key,e)},t.yt=function(){return lu.yt()},t.prototype.Xe=function(t){var e=this,n=bc(t);return n.get(Ga.key).next((function(t){return e.tn(t)?(bi("IndexedDbPersistence","Releasing primary lease."),n.delete(Ga.key)):uu.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(wi("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),!d()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return bi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return wi("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){wi("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function bc(t){return bu(t,Ga.store)}function wc(t){return bu(t,eu.store)}function _c(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Ec=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ji.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):zo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ji(e)).next((function(t){var e=Ks();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Ks();return this.Ut.getCollectionParents(t,i).next((function(s){return uu.forEach(s,(function(s){var a=function(t,e){return new jo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c);null==l&&(l=vo.newInvalidDocument(c),r=r.insert(c,l)),_s(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Yo(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Qs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Os&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Tc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Qs(),i=Qs(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ic=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ki.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Uo(e)||Bo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(mi()<=D.DEBUG&&bi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),$o(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Us(Jo(t));return e.forEach((function(e,r){Yo(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return mi()<=D.DEBUG&&bi("QueryEngine","Using full collection scan to execute query:",$o(e)),this.Sn.getDocumentsMatchingQuery(t,e,ki.min())},t}(),Sc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new js(Ci),this.Fn=new uc((function(t){return bo(t)}),wo),this.$n=ki.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Ec(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oc(t,e,n,r){return new Sc(t,e,n,r)}function Ac(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:return n=Si(t),r=n._n,o=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var i;return n._n.getAllMutationBatches(t).next((function(s){return i=s,r=n.persistence.getMutationQueue(e),o=new Ec(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Qs(),a=0,u=i;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return o.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return s=i.sent(),[2,(n._n=r,n.Mn=o,n.xn.Vn(n.Mn),s)]}}))}))}function Cc(t,e){var n=Si(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=uu.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Ii(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Nc(t){var e=Si(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Dc(t,e){var n=Si(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Ii(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Gs();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Qs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Gs();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(ki.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):bi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(ki.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return uu.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function xc(t,e){var n=Si(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function kc(t,e){var n=Si(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,uu.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Eu(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function Pc(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:r=Si(t),o=r.kn.get(e),s=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.referenceDelegate.removeTarget(t,o)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!pu(a=i.sent()))throw a;return bi("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(o.target),[2]}}))}))}function Rc(t,e,n){var r=Si(t),i=ki.min(),o=Qs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Si(t),i=r.Fn.get(n);return void 0!==i?uu.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,Ho(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:ki.min(),n?o:Qs())})).next((function(t){return{documents:t,Bn:o}}))}))}function Lc(t,e){var n=Si(t),r=Si(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Mc(t){var e=Si(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Si(t),i=Gs(),o=Ou(n),s=pc(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Wa.readTimeIndex,range:a},(function(t,e){var n=Iu(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Au(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function jc(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,(e=Si(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=pc(t),n=ki.min();return e.$t({index:Wa.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Au(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Fc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return uu.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:fa(n.createTime)}),uu.resolve()},t.prototype.getNamedQuery=function(t,e){return uu.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Pu(t.bundledQuery),readTime:fa(t.readTime)}}(e)),uu.resolve()},t}(),Vc=function(){function t(){this.Wn=new Us(Uc.Gn),this.zn=new Us(Uc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Uc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Uc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Ji(new ji([])),r=new Uc(n,t),i=new Uc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ji(new ji([])),n=new Uc(e,t),r=new Uc(e,t+1),i=Qs();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Uc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Uc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ji.comparator(t.key,e.key)||Ci(t.ns,e.ns)},t.Hn=function(t,e){return Ci(t.ns,e.ns)||Ji.comparator(t.key,e.key)},t}(),Bc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Us(Uc.Gn)}return t.prototype.checkEmpty=function(t){return uu.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new wu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Uc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return uu.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return uu.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return uu.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return uu.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return uu.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Uc(e,0),i=new Uc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),uu.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Us(Ci);return e.forEach((function(t){var e=new Uc(t,0),i=new Uc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),uu.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ji.isDocumentKey(i)||(i=i.child(""));var o=new Uc(new Ji(i),0),s=new Us(Ci);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),uu.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Ii(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return uu.forEach(e.mutations,(function(i){var o=new Uc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Uc(e,0),r=this.rs.firstAfterOrEqual(n);return uu.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,uu.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),qc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new js(Ji.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return uu.resolve(n?n.document.clone():vo.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Gs();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():vo.newInvalidDocument(t))})),uu.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Gs(),i=new Ji(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||Yo(e,c)&&(r=r.insert(c.key,c.clone()))}return uu.resolve(r)},t.prototype.fs=function(t,e){return uu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Gc(this)},t.prototype.getSize=function(t){return uu.resolve(this.size)},t}(),Gc=function(t){function n(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return e(n,t),n.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),uu.waitFor(n)},n.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},n.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},n}(cc),zc=function(){function t(t){this.persistence=t,this.ds=new uc((function(t){return bo(t)}),wo),this.lastRemoteSnapshotVersion=ki.min(),this.highestTargetId=0,this.ws=0,this._s=new Vc,this.targetCount=0,this.ys=$u.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),uu.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return uu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return uu.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),uu.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),uu.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new $u(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,uu.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),uu.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,uu.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),uu.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return uu.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return uu.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),uu.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),uu.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),uu.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return uu.resolve(n)},t.prototype.containsKey=function(t,e){return uu.resolve(this._s.containsKey(e))},t}(),Kc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new di(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new zc(this),this.Ut=new ju,this.Ue=function(t,e){return new qc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Tu(e),this.Ke=new Fc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Bc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;bi("MemoryPersistence","Starting transaction:",t);var i=new Hc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return uu.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Hc=function(t){function n(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return e(n,t),n}(su),Xc=function(){function t(t){this.persistence=t,this.As=new Vc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Ti()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),uu.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),uu.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),uu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return uu.forEach(this.vs,(function(r){var i=Ji.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return uu.or([function(){return uu.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Qc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wc(t,e){return"firestore_clients_"+t+"_"+e}function $c(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Yc(t,e){return"firestore_targets_"+t+"_"+e}Qc.UNAUTHENTICATED=new Qc(null),Qc.GOOGLE_CREDENTIALS=new Qc("google-credentials-uid"),Qc.FIRST_PARTY=new Qc("first-party-uid"),Qc.MOCK_USER=new Qc("mock-user");var Jc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new vi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(wi("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Zc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new vi(i.error.code,i.error.message)),o?new t(e,i.state,r):(wi("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),tl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=$s(),s=0;i&&s<r.activeTargetIds.length;++s)i=Yi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(wi("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),el=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(wi("SharedClientState","Failed to parse online state: "+e),null)},t}(),nl=function(){function t(){this.activeTargetIds=$s()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),rl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new js(Ci),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Wc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new nl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o,s,a,u,c,l,h,f=this;return i(this,(function(i){switch(i.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(o=this.getItem(Wc(this.persistenceKey,r)))&&(s=tl.Vs(r,o))&&(this.Fs=this.Fs.insert(s.clientId,s));for(this.Qs(),(a=this.storage.getItem(this.Us))&&(u=this.js(a))&&this.Ws(u),c=0,l=this.$s;c<l.length;c++)h=l[c],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Yc(this.persistenceKey,t));if(n){var r=Zc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Yc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return bi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){bi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){bi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(bi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void wi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return r(e,void 0,void 0,(function(){var t,e,r,o,s,a;return i(this,(function(i){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(o=this.ri(n.key,n.newValue)))return[2,this.oi(o)]}else if(n.key===this.Us){if(null!==n.newValue&&(s=this.js(n.newValue)))return[2,this.Ws(s)]}else if(n.key===this.Ms)(a=function(t){var e=di.o;if(null!=t)try{var n=JSON.parse(t);Ii("number"==typeof n),e=n}catch(t){wi("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==di.o&&this.sequenceNumberHandler(a);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Jc(this.currentUser,t,e,n),i=$c(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=$c(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Yc(this.persistenceKey,t),i=new Zc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return tl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Jc.Vs(new Qc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Zc.Vs(r,e)},t.prototype.js=function(t){return el.Vs(t)},t.prototype.ii=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(bi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=$s();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),il=function(){function t(){this.li=new nl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new nl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),ol=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),sl=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){bi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){bi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),al={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ul=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),cl=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return e(n,t),n.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new pi;s.listenOnce(ai.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case si.NO_ERROR:var e=s.getResponseJson();bi("Connection","XHR received:",JSON.stringify(e)),i(e);break;case si.TIMEOUT:bi("Connection",'RPC "'+t+'" timed out'),o(new vi(yi.DEADLINE_EXCEEDED,"Request time out"));break;case si.HTTP_ERROR:var n=s.getStatus();if(bi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(yi).indexOf(e)>=0?e:yi.UNKNOWN}(r.status);o(new vi(a,r.message))}else o(new vi(yi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new vi(yi.UNAVAILABLE,"Connection failed."));break;default:Ti()}}finally{bi("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},n.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new ei,o=Xe(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new hi({})),this.ki(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||p().indexOf("Electron/")>=0||function(){var t=p();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||p().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");bi("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,l=!1,h=new ul({Ei:function(t){l?bi("Connection","Not sending because WebChannel is closed:",t):(c||(bi("Connection","Opening WebChannel transport."),u.open(),c=!0),bi("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,fi.EventType.OPEN,(function(){l||bi("Connection","WebChannel transport opened.")})),f(u,fi.EventType.CLOSE,(function(){l||(l=!0,bi("Connection","WebChannel transport closed"),h.Vi())})),f(u,fi.EventType.ERROR,(function(t){l||(l=!0,_i("Connection","WebChannel transport errored:",t),h.Vi(new vi(yi.UNAVAILABLE,"The operation could not be completed")))})),f(u,fi.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];Ii(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){bi("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ds[t];if(void 0!==e)return Ms(e)}(o),a=i.message;void 0===s&&(s=yi.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new vi(s,a)),u.close()}else bi("Connection","WebChannel received:",n),h.Si(n)}})),f(o,ui.STAT_EVENT,(function(t){t.stat===ci?bi("Connection","Detected buffering proxy"):t.stat===li&&bi("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},n}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);bi("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return bi("RestConnection","Received: ",t),t}),(function(e){throw _i("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=al[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ll(){return"undefined"!=typeof window?window:null}function hl(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fl(t){return new ua(t,!0)}var pl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&bi("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),dl=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new pl(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===yi.RESOURCE_EXHAUSTED?(wi(e.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===yi.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new vi(yi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return bi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(bi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),yl=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return e(n,t),n.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},n.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ti()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Ii(void 0===e||"string"==typeof e),Bi.fromBase64String(e||"")):(Ii(void 0===e||e instanceof Uint8Array),Bi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?yi.UNKNOWN:Ms(t.code);return new vi(e,t.message||"")}(a);n=new ea(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=va(t,r.document.name),o=fa(r.document.updateTime);var a=new po({mapValue:{fields:r.document.fields}}),u=(s=vo.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Zs(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=va(t,r.document),o=r.readTime?fa(r.readTime):ki.min(),a=vo.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Zs([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=va(t,r.document),o=r.removedTargetIds||[],n=new Zs([],o,i,null);else{if(!("filter"in e))return Ti();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new Rs(r),o=l.targetId,n=new ta(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return ki.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ki.min():e.readTime?fa(e.readTime):ki.min()}(t);return this.listener._r(e,n)},n.prototype.mr=function(t){var e={};e.database=ba(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=_o(r)?{documents:Ia(t,r)}:{query:Sa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=la(t,e.resumeToken):e.snapshotVersion.compareTo(ki.min())>0&&(n.readTime=ca(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ti()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},n.prototype.yr=function(t){var e={};e.database=ba(this.R),e.removeTarget=t,this.cr(e)},n}(dl),vl=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return e(n,t),Object.defineProperty(n.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.ar=function(){this.gr&&this.Er([])},n.prototype.wr=function(t){return this.Hi.Oi("Write",t)},n.prototype.onMessage=function(t){if(Ii(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Ii(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?fa(t.updateTime):fa(e);return n.isEqual(ki.min())&&(n=fa(e)),new vs(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=fa(t.commitTime);return this.listener.Tr(n,e)}return Ii(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},n.prototype.Ar=function(){var t={};t.database=ba(this.R),this.cr(t)},n.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ea(e.R,t)}))};this.cr(n)},n}(dl),gl=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return e(n,t),n.prototype.br=function(){if(this.Rr)throw new vi(yi.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===yi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new vi(yi.UNKNOWN,t.toString())}))},n.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===yi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new vi(yi.UNKNOWN,t.toString())}))},n.prototype.terminate=function(){this.Rr=!0},n}((function(){})),ml=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(wi(e),this.Vr=!1):bi("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),bl=function(t,e,n,o,s){var a=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=s,this.Lr.di((function(t){n.enqueueAndForget((function(){return r(a,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return Cl(this)?(bi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=Si(t)).Or.add(4),[4,_l(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,wl(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new ml(n,o)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wl(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:if(!Cl(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function _l(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function El(t,e){var n=Si(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Al(n)?Ol(n):Gl(n).er()&&Il(n,e))}function Tl(t,e){var n=Si(t),r=Gl(n);n.$r.delete(e),r.er()&&Sl(n,e),0===n.$r.size&&(r.er()?r.ir():Cl(n)&&n.Br.set("Unknown"))}function Il(t,e){t.qr.U(e.targetId),Gl(t).mr(e)}function Sl(t,e){t.qr.U(e),Gl(t).yr(e)}function Ol(t){t.qr=new ra({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Gl(t).start(),t.Br.Sr()}function Al(t){return Cl(t)&&!Gl(t).tr()&&t.$r.size>0}function Cl(t){return 0===Si(t).Or.size}function Nl(t){t.qr=void 0}function Dl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.$r.forEach((function(e,n){Il(t,e)})),[2]}))}))}function xl(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return Nl(t),Al(t)?(t.Br.Nr(e),Ol(t)):t.Br.set("Unknown"),[2]}))}))}function kl(t,e,n){return r(this,void 0,void 0,(function(){var o,s,a;return i(this,(function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof ea&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(s=o[r],t.$r.has(s)?[4,t.remoteSyncer.rejectListen(s,n)]:[3,3]):[3,5];case 2:i.sent(),t.$r.delete(s),t.qr.removeTarget(s),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return o=u.sent(),bi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),[4,Pl(t,o)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Zs?t.qr.X(e):e instanceof ta?t.qr.rt(e):t.qr.et(e),n.isEqual(ki.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Nc(t.localStore)];case 8:return s=u.sent(),n.compareTo(s)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Bi.EMPTY_BYTE_STRING,n.snapshotVersion)),Sl(t,e);var r=new Eu(n.target,e,1,n.sequenceNumber);Il(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return bi("RemoteStore","Failed to raise snapshot:",a=u.sent()),[4,Pl(t,a)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Pl(t,e,n){return r(this,void 0,void 0,(function(){var o=this;return i(this,(function(s){switch(s.label){case 0:if(!pu(e))throw e;return t.Or.add(1),[4,_l(t)];case 1:return s.sent(),t.Br.set("Offline"),n||(n=function(){return Nc(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return bi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,wl(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Rl(t,e){return e().catch((function(n){return Pl(t,n,e)}))}function Ll(t){return r(this,void 0,void 0,(function(){var e,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:e=Si(t),n=zl(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,i.label=1;case 1:if(!function(t){return Cl(t)&&t.Fr.length<10}(e))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,xc(e.localStore,r)];case 3:return null===(o=i.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=o.batchId,function(t,e){t.Fr.push(e);var n=zl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,o),[3,6]);case 4:return s=i.sent(),[4,Pl(e,s)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return Ml(e)&&jl(e),[2]}}))}))}function Ml(t){return Cl(t)&&!zl(t).tr()&&t.Fr.length>0}function jl(t){zl(t).start()}function Fl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return zl(t).Ar(),[2]}))}))}function Vl(t){return r(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){for(e=zl(t),n=0,r=t.Fr;n<r.length;n++)o=r[n],e.Er(o.mutations);return[2]}))}))}function Ul(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=t.Fr.shift(),o=_u.from(r,e,n),[4,Rl(t,(function(){return t.remoteSyncer.applySuccessfulWrite(o)}))];case 1:return i.sent(),[4,Ll(t)];case 2:return i.sent(),[2]}}))}))}function Bl(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e&&zl(t).pr?[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return Ls(r=e.code)&&r!==yi.ABORTED?(n=t.Fr.shift(),zl(t).sr(),[4,Rl(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Ll(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Ml(t)&&jl(t),[2]}}))}))}function ql(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=Si(t),e?(n.Or.delete(2),[4,wl(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,_l(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Gl(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Si(t);return r.br(),new yl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Dl.bind(null,t),Ri:xl.bind(null,t),_r:kl.bind(null,t)}),t.Mr.push((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Al(t)?Ol(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Nl(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function zl(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Si(t);return r.br(),new vl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Fl.bind(null,t),Ri:Bl.bind(null,t),Ir:Vl.bind(null,t),Tr:Ul.bind(null,t)}),t.Mr.push((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Ll(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(bi("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Kl=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new au,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new vi(yi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Hl(t,e){if(wi("AsyncQueue",e+": "+t),pu(t))return new vi(yi.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xl=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ji.comparator(e.key,n.key)}:function(t,e){return Ji.comparator(t.key,e.key)},this.keyedMap=Ks(),this.sortedSet=new js(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Ql=function(){function t(){this.Qr=new js(Ji.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Ti():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Wl=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Xl.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Qo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),$l=function(){this.Wr=void 0,this.listeners=[]},Yl=function(){this.queries=new uc((function(t){return Wo(t)}),Qo),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jl(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c;return i(this,(function(i){switch(i.label){case 0:if(n=Si(t),r=e.query,o=!1,(s=n.queries.get(r))||(o=!0,s=new $l),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),a=s,[4,n.onListen(r)];case 2:return a.Wr=i.sent(),[3,4];case 3:return u=i.sent(),c=Hl(u,"Initialization of query '"+$o(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.zr(n.onlineState),s.Wr&&e.Hr(s.Wr)&&nh(n),[2]}}))}))}function Zl(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a;return i(this,(function(i){return n=Si(t),r=e.query,o=!1,(s=n.queries.get(r))&&(a=s.listeners.indexOf(e))>=0&&(s.listeners.splice(a,1),o=0===s.listeners.length),o?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function th(t,e){for(var n=Si(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);u.Wr=s}}r&&nh(n)}function eh(t,e,n){var r=Si(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function nh(t){t.Gr.forEach((function(t){t.next()}))}var rh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Wl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Wl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),ih=function(t){this.key=t},oh=function(t){this.key=t},sh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Qs(),this.mutatedKeys=Qs(),this.lo=Jo(t),this.fo=new Xl(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Ql,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Uo(this.query)&&i.size===this.query.limit?i.last():null,c=Bo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=Yo(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data.isEqual(h.data)?f!==p&&(r.track({type:3,doc:h}),d=!0):n.yo(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(a=!0)),d&&(h?(s=s.add(h),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Uo(this.query)||Bo(this.query))for(;s.size>this.query.limit;){var l=Uo(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ti()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Wl(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Ql,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Qs(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new oh(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new ih(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Qs();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Wl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),ah=function(t,e,n){this.query=t,this.targetId=e,this.view=n},uh=function(t){this.key=t,this.bo=!1},ch=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new uc((function(t){return Wo(t)}),Qo),this.Vo=new Map,this.So=new Set,this.Do=new js(Ji.comparator),this.Co=new Map,this.No=new Vc,this.xo={},this.ko=new Map,this.Fo=$u.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return n=Vh(t),(s=n.Po.get(e))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),o=s.view.Ro(),[3,4]):[3,1];case 1:return[4,kc(n.localStore,Ho(e))];case 2:return a=i.sent(),u=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,hh(n,e,r,"current"===u)];case 3:o=i.sent(),n.isPrimaryClient&&El(n.remoteStore,a),i.label=4;case 4:return[2,o]}}))}))}function hh(t,e,n,o){return r(this,void 0,void 0,(function(){var s,a,u,c,l,h;return i(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,o){return function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a;return i(this,(function(i){switch(i.label){case 0:return(r=e.view._o(n)).Nn?[4,Rc(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,r)}))]:[3,2];case 1:r=i.sent(),i.label=2;case 2:return s=o&&o.targetChanges.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s),[2,(Ih(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,o)},[4,Rc(t.localStore,e,!0)];case 1:return s=f.sent(),a=new sh(e,s.Bn),u=a._o(s.documents),c=Js.createSynthesizedTargetChangeForCurrentChange(n,o&&"Offline"!==t.onlineState),l=a.applyChanges(u,t.isPrimaryClient,c),Ih(t,n,l.To),h=new ah(e,n,a),[2,(t.Po.set(e,h),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),l.snapshot)]}}))}))}function fh(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=Si(t),r=n.Po.get(e),(o=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,o.filter((function(t){return!Qo(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Pc(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Tl(n.remoteStore,r.targetId),Eh(n,r.targetId)})).catch(ec)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return Eh(n,r.targetId),[4,Pc(n.localStore,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))}function ph(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:r=Uh(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,function(t,e){var n,r=Si(t),i=xi.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Qs());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=Es(c,n.get(c.key));null!=l&&s.push(new Os(c.key,l,yo(l.value.mapValue),gs.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return o=i.sent(),r.sharedClientState.addPendingMutation(o.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new js(Ci)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,o.batchId,n),[4,Ah(r,o.changes)];case 3:return i.sent(),[4,Ll(r.remoteStore)];case 4:return i.sent(),[3,6];case 5:return s=i.sent(),a=Hl(s,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function dh(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:n=Si(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Dc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Ii(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Ii(r.bo):t.removedDocuments.size>0&&(Ii(r.bo),r.bo=!1))})),[4,Ah(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ec(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function yh(t,e,n){var r=Si(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Si(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&nh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function vh(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u,c;return i(this,(function(i){switch(i.label){case 0:return(r=Si(t)).sharedClientState.updateQueryState(e,"rejected",n),o=r.Co.get(e),(s=o&&o.key)?(a=(a=new js(Ji.comparator)).insert(s,vo.newNoDocument(s,ki.min())),u=Qs().add(s),c=new Ys(ki.min(),new Map,new Us(Ci),a,u),[4,dh(r,c)]):[3,2];case 1:return i.sent(),r.Do=r.Do.remove(s),r.Co.delete(e),Oh(r),[3,4];case 2:return[4,Pc(r.localStore,e,!1).then((function(){return Eh(r,e,n)})).catch(ec)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))}function gh(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:n=Si(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Cc(n.localStore,e)];case 2:return o=i.sent(),_h(n,r,null),wh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Ah(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,ec(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function mh(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:r=Si(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=Si(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Ii(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return o=i.sent(),_h(r,e,n),wh(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Ah(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,ec(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function bh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a;return i(this,(function(i){switch(i.label){case 0:Cl((n=Si(t)).remoteStore)||bi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,function(t){var e=Si(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.ko.get(r)||[]).push(e),n.ko.set(r,o),[3,4]);case 3:return s=i.sent(),a=Hl(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function wh(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function _h(t,e,n){var r=Si(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Eh(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Th(t,e)}))}function Th(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Tl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Oh(t))}function Ih(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof ih?(t.No.addReference(o.key,e),Sh(t,o)):o instanceof oh?(bi("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Th(t,o.key)):Ti()}}function Sh(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(bi("SyncEngine","New document in limbo: "+n),t.So.add(r),Oh(t))}function Oh(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ji(ji.fromString(e)),r=t.Fo.next();t.Co.set(r,new uh(n)),t.Do=t.Do.insert(n,r),El(t.remoteStore,new Eu(Ho(Vo(n.path)),r,2,di.o))}}function Ah(t,e,n){return r(this,void 0,void 0,(function(){var o,s,a,u;return i(this,(function(c){switch(c.label){case 0:return o=Si(t),s=[],a=[],u=[],o.Po.isEmpty()?[3,3]:(o.Po.forEach((function(t,r){u.push(o.Oo(r,e,n).then((function(t){if(t){o.isPrimaryClient&&o.sharedClientState.updateQueryState(r.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=Tc.Pn(r.targetId,t);a.push(e)}})))})),[4,Promise.all(u)]);case 1:return c.sent(),o.vo._r(s),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,l,h;return i(this,(function(i){switch(i.label){case 0:n=Si(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return uu.forEach(e,(function(e){return uu.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return uu.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return i.sent(),[3,4];case 3:if(!pu(r=i.sent()))throw r;return bi("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,s=e;o<s.length;o++)a=s[o],u=a.targetId,a.fromCache||(c=n.kn.get(u),l=c.snapshotVersion,h=c.withLastLimboFreeSnapshotVersion(l),n.kn=n.kn.insert(u,h));return[2]}}))}))}(o.localStore,a)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Ch(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=Si(t)).currentUser.isEqual(e)?[3,3]:(bi("SyncEngine","User change. New user:",e.toKey()),[4,Ac(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new vi(yi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Ah(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Nh(t,e){var n=Si(t),r=n.Co.get(e);if(r&&r.bo)return Qs().add(r.key);var i=Qs(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Dh(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,Rc((n=Si(t)).localStore,e.query,!0)];case 1:return r=i.sent(),o=e.view.Ao(r),[2,(n.isPrimaryClient&&Ih(n,e.targetId,o.To),o)]}}))}))}function xh(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,Mc((e=Si(t)).localStore).then((function(t){return Ah(e,t)}))]}))}))}function kh(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return[4,function(t,e){var n=Si(t),r=Si(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):uu.resolve(null)}))}))}((r=Si(t)).localStore,e)];case 1:return null===(s=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,Ll(r.remoteStore)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(_h(r,e,o||null),wh(r,e),function(t,e){Si(Si(t)._n).Gt(e)}(r.localStore,e)):Ti(),i.label=4;case 4:return[4,Ah(r,s)];case 5:return i.sent(),[3,7];case 6:bi("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}}))}))}function Ph(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,l;return i(this,(function(i){switch(i.label){case 0:return Vh(n=Si(t)),Uh(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Rh(n,r.toArray())]);case 1:return o=i.sent(),n.$o=!0,[4,ql(n.remoteStore,!0)];case 2:for(i.sent(),s=0,a=o;s<a.length;s++)u=a[s],El(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],l=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):l=l.then((function(){return Eh(n,e),Pc(n.localStore,e,!0)})),Tl(n.remoteStore,e)})),[4,l]);case 4:return i.sent(),[4,Rh(n,c)];case 5:return i.sent(),function(t){var e=Si(t);e.Co.forEach((function(t,n){Tl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new js(Ji.comparator)}(n),n.$o=!1,[4,ql(n.remoteStore,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))}function Rh(t,e,n){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,l,h,f,p,d,y,v;return i(this,(function(i){switch(i.label){case 0:n=Si(t),r=[],o=[],s=0,a=e,i.label=1;case 1:return s<a.length?(u=a[s],c=void 0,(l=n.Vo.get(u))&&0!==l.length?[4,kc(n.localStore,Ho(l[0]))]:[3,7]):[3,13];case 2:c=i.sent(),h=0,f=l,i.label=3;case 3:return h<f.length?(p=f[h],d=n.Po.get(p),[4,Dh(n,d)]):[3,6];case 4:(y=i.sent()).snapshot&&o.push(y.snapshot),i.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Lc(n.localStore,u)];case 8:return v=i.sent(),[4,kc(n.localStore,v)];case 9:return c=i.sent(),[4,hh(n,Lh(v),u,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return s++,[3,1];case 13:return[2,(n.vo._r(o),r)]}}))}))}function Lh(t){return Fo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Mh(t){var e=Si(t);return Si(Si(e.localStore).persistence).fn()}function jh(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a;return i(this,(function(i){switch(i.label){case 0:return(r=Si(t)).$o?(bi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!r.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Mc(r.localStore)];case 3:return s=i.sent(),a=Ys.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Ah(r,s,a)];case 4:return i.sent(),[3,8];case 5:return[4,Pc(r.localStore,e,!0)];case 6:return i.sent(),Eh(r,e,o),[3,8];case 7:Ti(),i.label=8;case 8:return[2]}}))}))}function Fh(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u,c,l,h,f,p;return i(this,(function(d){switch(d.label){case 0:if(!(r=Vh(t)).$o)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?(a=s[o],r.Vo.has(a)?(bi("SyncEngine","Adding an already active target "+a),[3,5]):[4,Lc(r.localStore,a)]):[3,6];case 2:return u=d.sent(),[4,kc(r.localStore,u)];case 3:return c=d.sent(),[4,hh(r,Lh(u),c.targetId,!1)];case 4:d.sent(),El(r.remoteStore,c),d.label=5;case 5:return o++,[3,1];case 6:l=function(t){return i(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Pc(r.localStore,t,!1).then((function(){Tl(r.remoteStore,t),Eh(r,t)})).catch(ec)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,d.label=7;case 7:return h<f.length?(p=f[h],[5,l(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Vh(t){var e=Si(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Nh.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vh.bind(null,e),e.vo._r=th.bind(null,e.eventManager),e.vo.Mo=eh.bind(null,e.eventManager),e}function Uh(t){var e=Si(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mh.bind(null,e),e}var Bh=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.R=fl(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Oc(this.persistence,new Ic,t.initialUser,this.R)},t.prototype.qo=function(t){return new Kc(Xc.bs,this.R)},t.prototype.Bo=function(t){return new il},t.prototype.terminate=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),qh=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,jc(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,Uh(this.Qo.syncEngine)];case 4:return r.sent(),[4,Ll(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},n.prototype.Ko=function(t){return Oc(this.persistence,new Ic,t.initialUser,this.R)},n.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new ic(e,t.asyncQueue)},n.prototype.qo=function(t){var e=_c(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?qu.withCacheSize(this.cacheSizeBytes):qu.DEFAULT;return new mc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,ll(),hl(),this.R,this.sharedClientState,!!this.forceOwnership)},n.prototype.Bo=function(t){return new il},n}(Bh),Gh=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){var n,o=this;return i(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof rl?(this.sharedClientState.syncEngine={ui:kh.bind(null,n),ai:jh.bind(null,n),hi:Fh.bind(null,n),fn:Mh.bind(null,n),ci:xh.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.He((function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,Ph(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},n.prototype.Bo=function(t){var e=ll();if(!rl.yt(e))throw new vi(yi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=_c(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new rl(e,t.asyncQueue,n,t.clientId,t.initialUser)},n}(qh),zh=function(){function t(){}return t.prototype.initialize=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return yh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Ch.bind(null,this.syncEngine),[4,ql(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Yl},t.prototype.createDatastore=function(t){var e,n=fl(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new cl(e));return function(t,e,n){return new gl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return yh(s.syncEngine,t,0)},o=sl.yt()?new sl:new ol,new bl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new ch(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Si(t),bi("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,_l(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),Kh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Hh=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new vi(yi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return n=Si(t),r=ba(n.R)+"/documents",o={documents:e.map((function(t){return ya(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,o)];case 1:return s=i.sent(),a=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Ii(!!e.found),e.found.name,e.found.updateTime;var n=va(t,e.found.name),r=fa(e.found.updateTime),i=new po({mapValue:{fields:e.found.fields}});return vo.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Ii(!!e.missing),Ii(!!e.readTime);var n=va(t,e.missing),r=fa(e.readTime);return vo.newNoDocument(n,r)}(t,e):Ti()}(n.R,t);a.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Ii(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=o.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new ks(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Ji.fromPath(n);e.mutations.push(new Ps(r,e.precondition(r)))})),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=Si(t),r=ba(n.R)+"/documents",o={writes:e.map((function(t){return Ea(n.R,t)}))},[4,n.Ni("Commit",r,o)];case 1:return i.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Ti();e=ki.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new vi(yi.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?gs.updateTime(e):gs.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ki.min()))throw new vi(yi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)}return gs.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Xh=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new pl(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return r(t,void 0,void 0,(function(){var t,e,n=this;return i(this,(function(r){return t=new Hh(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Wi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ls(e)}return!1},t}(),Qh=function(){function t(t,e,n){var o=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Qc.UNAUTHENTICATED,this.clientId=Ai.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return bi("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new vi(yi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new au;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return r(t,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Hl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Wh(t,e){return r(this,void 0,void 0,(function(){var n,o,s=this;return i(this,(function(a){switch(a.label){case 0:return t.asyncQueue.verifyOperationInProgress(),bi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=a.sent(),[4,e.initialize(n)];case 2:return a.sent(),o=n.initialUser,t.setCredentialChangeListener((function(t){return r(s,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return o.isEqual(t)?[3,2]:[4,Ac(e.localStore,t)];case 1:n.sent(),o=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function $h(t,e){return r(this,void 0,void 0,(function(){var n,o;return i(this,(function(s){switch(s.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Yh(t)];case 1:return n=s.sent(),bi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return o=s.sent(),[4,e.initialize(n,o)];case 3:return s.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=Si(t)).asyncQueue.verifyOperationInProgress(),bi("RemoteStore","RemoteStore received new credentials"),r=Cl(n),n.Or.add(3),[4,_l(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,wl(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Yh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(bi("FirestoreClient","Using default OfflineComponentProvider"),[4,Wh(t,new Bh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Jh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(bi("FirestoreClient","Using default OnlineComponentProvider"),[4,$h(t,new zh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Zh(t){return Yh(t).then((function(t){return t.persistence}))}function tf(t){return Yh(t).then((function(t){return t.localStore}))}function ef(t){return Jh(t).then((function(t){return t.remoteStore}))}function nf(t){return Jh(t).then((function(t){return t.syncEngine}))}function rf(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Jh(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=lh.bind(null,e.syncEngine),n.onUnlisten=fh.bind(null,e.syncEngine),n)]}}))}))}function of(t,e,n){var o=this;void 0===n&&(n={});var s=new au;return t.asyncQueue.enqueueAndForget((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Kh({next:function(o){e.enqueueAndForget((function(){return Zl(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new vi(yi.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new vi(yi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new rh(Vo(n.path),o,{includeMetadataChanges:!0,so:!0});return Jl(t,s)},[4,rf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}function sf(t,e,n){var o=this;void 0===n&&(n={});var s=new au;return t.asyncQueue.enqueueAndForget((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Kh({next:function(n){e.enqueueAndForget((function(){return Zl(t,s)})),n.fromCache&&"server"===r.source?i.reject(new vi(yi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new rh(n,o,{includeMetadataChanges:!0,so:!0});return Jl(t,s)},[4,rf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}var af=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},uf=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),cf=new Map,lf=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},hf=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Qc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),ff=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),pf=function(){function t(t){var e=this;this.currentUser=Qc.UNAUTHENTICATED,this.oc=new au,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){bi("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(bi("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(bi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ii("string"==typeof n.accessToken),new lf(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return r(n,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Ii(null===t||"string"==typeof t),new Qc(t)},t}(),df=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Qc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),yf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new df(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Qc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vf(t,e,n){if(!n)throw new vi(yi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function gf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new vi(yi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function mf(t,e,n,r){if(!0===e&&!0===r)throw new vi(yi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function bf(t){if(!Ji.isDocumentKey(t))throw new vi(yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function wf(t){if(Ji.isDocumentKey(t))throw new vi(yi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function _f(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ti()}function Ef(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new vi(yi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=_f(t);throw new vi(yi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Tf(t,e){if(e<=0)throw new vi(yi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var If=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new vi(yi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new vi(yi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,mf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Sf=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new If({}),this._settingsFrozen=!1,t instanceof uf?(this._databaseId=t,this._credentials=new hf):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new vi(yi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uf(t.options.projectId)}(t),this._credentials=new pf(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new vi(yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new vi(yi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new If(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new hf;switch(t.type){case"gapi":var e=t.client;return Ii(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new yf(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new vi(yi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=cf.get(this))&&(bi("ComponentProvider","Removing Datastore"),cf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Of=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Cf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Af=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Cf=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,Vo(r))||this)._path=r,i.type="collection",i}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Of(this.firestore,null,new Ji(t))},enumerable:!1,configurable:!0}),n.prototype.withConverter=function(t){return new n(this.firestore,t,this._path)},n}(Af);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=T(t),vf("collection","path",e),t instanceof Sf)return wf(n=ji.fromString.apply(ji,a([e],r))),new Cf(t,null,n);if(!(t instanceof Of||t instanceof Cf))throw new vi(yi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wf(n=ji.fromString.apply(ji,a([t.path],r)).child(ji.fromString(e))),new Cf(t.firestore,null,n)}function Df(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=T(t),1===arguments.length&&(e=Ai.u()),vf("doc","path",e),t instanceof Sf)return bf(n=ji.fromString.apply(ji,a([e],r))),new Of(t,null,new Ji(n));if(!(t instanceof Of||t instanceof Cf))throw new vi(yi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return bf(n=t._path.child(ji.fromString.apply(ji,a([e],r)))),new Of(t.firestore,t instanceof Cf?t.converter:null,new Ji(n))}function xf(t,e){return t=T(t),e=T(e),(t instanceof Of||t instanceof Cf)&&(e instanceof Of||e instanceof Cf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function kf(t,e){return t=T(t),e=T(e),t instanceof Af&&e instanceof Af&&t.firestore===e.firestore&&Qo(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Pf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new pl(this,"async_queue_retry"),this.Ic=function(){var e=hl();e&&bi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=hl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=hl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new au;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!pu(t=n.sent()))throw t;return bi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,wi("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=Kl.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Ti()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Rf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Lf=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new Pf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return e(n,t),n.prototype._terminate=function(){return this._firestoreClient||jf(this),this._firestoreClient.terminate()},n}(Sf);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Mf(t){return t._firestoreClient||jf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function jf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new af(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Qh(t._credentials,t._queue,r)}function Ff(t,e,n){var o=this,s=new au;return t.asyncQueue.enqueue((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Wh(t,n)];case 1:return i.sent(),[4,$h(t,e)];case 2:return i.sent(),s.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===yi.FAILED_PRECONDITION||t.code===yi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=i.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return s.promise}))}function Vf(t){if(t._initialized||t._terminated)throw new vi(yi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Uf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new vi(yi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Bf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Bi.fromBase64String(e))}catch(e){throw new vi(yi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Bi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),qf=function(t){this._methodName=t},Gf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new vi(yi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new vi(yi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Ci(this._lat,t._lat)||Ci(this._long,t._long)},t}(),zf=/^__.*__$/,Kf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Os(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ss(t,this.data,e,this.fieldTransforms)},t}(),Hf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Os(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ti()}}var Qf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return dp(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Xf(this.Nc)&&zf.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),Wf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||fl(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Qf({Nc:t,methodName:e,qc:n,path:Vi.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function $f(t){var e=t._freezeSettings(),n=fl(t._databaseId);return new Wf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);lp("Data must be an object, but it was:",s,r);var a,u,c=up(r,s);if(o.merge)a=new Ui(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=hp(e,f[h],n);if(!s.contains(p))throw new vi(yi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");yp(l,p)||l.push(p)}a=new Ui(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Kf(new po(c),a,u)}var Jf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(qf);function Zf(t,e,n){return new Qf({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var tp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype._toFieldTransform=function(t){return new ys(t.path,new as)},n.prototype.isEqual=function(t){return t instanceof n},n}(qf),ep=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=Zf(this,t,!0),n=this.Kc.map((function(t){return ap(t,e)})),r=new us(n);return new ys(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(qf),np=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=Zf(this,t,!0),n=this.Kc.map((function(t){return ap(t,e)})),r=new ls(n);return new ys(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(qf),rp=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=new fs(t.R,ns(t.R,this.Qc));return new ys(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(qf);function ip(t,e,n,r){var i=t.Uc(1,e,n);lp("Data must be an object, but it was:",i,r);var o=[],s=po.empty();Ri(r,(function(t,r){var a=pp(e,t,n);r=T(r);var u=i.Oc(a);if(r instanceof Jf)o.push(a);else{var c=ap(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Ui(o);return new Hf(s,a,i.fieldTransforms)}function op(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[hp(e,r,n)],u=[i];if(o.length%2!=0)throw new vi(yi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(hp(e,o[c])),u.push(o[c+1]);for(var l=[],h=po.empty(),f=a.length-1;f>=0;--f)if(!yp(l,a[f])){var p=a[f],d=u[f];d=T(d);var y=s.Oc(p);if(d instanceof Jf)l.push(p);else{var v=ap(d,y);null!=v&&(l.push(p),h.set(p,v))}}var g=new Ui(l);return new Hf(h,g,s.fieldTransforms)}function sp(t,e,n,r){return void 0===r&&(r=!1),ap(n,t.Uc(r?4:3,e))}function ap(t,e){if(cp(t=T(t)))return lp("Unsupported field value:",e,t),up(t,e);if(t instanceof qf)return function(t,e){if(!Xf(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ap(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=T(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ns(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=xi.fromDate(t);return{timestampValue:ca(e.R,n)}}if(t instanceof xi)return n=new xi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ca(e.R,n)};if(t instanceof Gf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bf)return{bytesValue:la(e.R,t._byteString)};if(t instanceof Of){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:pa(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+_f(t))}(t,e)}function up(t,e){var n={};return Li(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ri(t,(function(t,r){var i=ap(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function cp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof xi||t instanceof Gf||t instanceof Bf||t instanceof Of||t instanceof qf)}function lp(t,e,n){if(!cp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=_f(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function hp(t,e,n){if((e=T(e))instanceof Uf)return e._internalPath;if("string"==typeof e)return pp(t,e);throw dp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var fp=new RegExp("[~\\*/\\[\\]]");function pp(t,e,n){if(e.search(fp)>=0)throw dp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Uf.bind.apply(Uf,a([void 0],e.split(".")))))._internalPath}catch(r){throw dp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function dp(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new vi(yi.INVALID_ARGUMENT,(a+=". ")+t+u)}function yp(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vp=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Of(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new gp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(mp("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),gp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(){return t.prototype.data.call(this)},n}(vp);function mp(t,e){return"string"==typeof e?pp(t,e):e instanceof Uf?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var bp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),wp=function(t){function n(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return e(n,t),n.prototype.exists=function(){return t.prototype.exists.call(this)},n.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},n.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(mp("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},n}(vp),_p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},n}(wp),Ep=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new bp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new _p(n._firestore,n._userDataWriter,r.key,r,new bp(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new vi(yi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new _p(t._firestore,t._userDataWriter,e.doc.key,e.doc,new bp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new _p(t._firestore,t._userDataWriter,e.doc.key,e.doc,new bp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Tp(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Tp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ti()}}function Ip(t,e){return t instanceof wp&&e instanceof wp?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ep&&e instanceof Ep&&t._firestore===e._firestore&&kf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sp(t){if(Bo(t)&&0===t.explicitOrderBy.length)throw new vi(yi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Op=function(){};function Ap(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Cp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return e(n,t),n.prototype._apply=function(t){var e=$f(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new vi(yi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Lp(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(Rp(r,t,h))}a={arrayValue:{values:u}}}else a=Rp(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Lp(s,o),a=sp(n,"where",s,"in"===o||"not-in"===o);var f=Eo.create(i,o,a);return function(t,e){if(e.g()){var n=Go(t);if(null!==n&&!n.isEqual(e.field))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=qo(t);null!==r&&Mp(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new vi(yi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new vi(yi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Af(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},n}(Op),Np=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return e(n,t),n.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new vi(yi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new vi(yi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Po(e,n);return function(t,e){if(null===qo(t)){var n=Go(t);null!==n&&Mp(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Af(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new jo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},n}(Op),Dp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return e(n,t),n.prototype._apply=function(t){return new Af(t.firestore,t.converter,Xo(t._query,this.Hc,this.Jc))},n}(Op),xp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return e(n,t),n.prototype._apply=function(t){var e=Pp(t,this.type,this.Yc,this.Xc);return new Af(t.firestore,t.converter,function(t,e){return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},n}(Op),kp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return e(n,t),n.prototype._apply=function(t){var e=Pp(t,this.type,this.Yc,this.Xc);return new Af(t.firestore,t.converter,function(t,e){return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},n}(Op);function Pp(t,e,n,r){if(n[0]=T(n[0]),n[0]instanceof vp)return function(t,e,n,r,i){if(!r)throw new vi(yi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Ko(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(so(e,r.key));else{var c=r.data.field(u.field);if(Hi(c))throw new vi(yi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new vi(yi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new xo(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=$f(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new vi(yi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new vi(yi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!zo(t)&&-1!==c.indexOf("/"))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(ji.fromString(c));if(!Ji.isDocumentKey(l))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Ji(l);a.push(so(e,h))}else{var f=sp(n,r,c);a.push(f)}}return new xo(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Rp(t,e,n){if("string"==typeof(n=T(n))){if(""===n)throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!zo(e)&&-1!==n.indexOf("/"))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ji.fromString(n));if(!Ji.isDocumentKey(r))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return so(t,new Ji(r))}if(n instanceof Of)return so(t,n._key);throw new vi(yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+_f(n)+".")}function Lp(t,e){if(!Array.isArray(t)||0===t.length)throw new vi(yi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new vi(yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Mp(t,e,n){if(!n.isEqual(e))throw new vi(yi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jp=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Zi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return zi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ki(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ti()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Ri(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Gf(zi(t.latitude),zi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Xi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Qi(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Gi(t);return new xi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ji.fromString(t);Ii(ja(n));var r=new uf(n.get(1),n.get(3)),i=new Ji(n.popFirst(5));return r.isEqual(e)||wi("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Vp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new Bf(t)},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Of(this.firestore,null,e)},n}(jp),Up=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=$f(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Bp(t,this._firestore),i=Fp(r.converter,e,n),o=Yf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,gs.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Bp(t,this._firestore);return o="string"==typeof(e=T(e))||e instanceof Uf?op(this._dataReader,"WriteBatch.update",s._key,e,n,r):ip(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,gs.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Bp(t,this._firestore);return this._mutations=this._mutations.concat(new ks(e._key,gs.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new vi(yi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bp(t,e){if((t=T(t)).firestore!==e)throw new vi(yi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new Bf(t)},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Of(this.firestore,null,e)},n}(jp);function Gp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ef(t,Of);var o=Ef(t.firestore,Lf),s=$f(o);return Kp(o,[("string"==typeof(e=T(e))||e instanceof Uf?op(s,"updateDoc",t._key,e,n,r):ip(s,"updateDoc",t._key,e)).toMutation(t._key,gs.exists(!0))])}function zp(t){for(var e,n,o,s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];t=T(t);var u={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||Rf(s[c])||(u=s[c],c++);var l,h,f,p={includeMetadataChanges:u.includeMetadataChanges};if(Rf(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(t instanceof Of)h=Ef(t.firestore,Lf),f=Vo(t._key.path),l={next:function(e){s[c]&&s[c](Hp(h,t,e))},error:s[c+1],complete:s[c+2]};else{var y=Ef(t,Af);h=Ef(y.firestore,Lf),f=y._query;var v=new qp(h);l={next:function(t){s[c]&&s[c](new Ep(h,v,y,t))},error:s[c+1],complete:s[c+2]},Sp(t._query)}return function(t,e,n,o){var s=this,a=new Kh(o),u=new rh(e,a,n);return t.asyncQueue.enqueueAndForget((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Jl,[4,rf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){a.Wo(),t.asyncQueue.enqueueAndForget((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Zl,[4,rf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Mf(h),f,p,l)}function Kp(t,e){return function(t,e){var n=this,o=new au;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=ph,[4,nf(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,o])]}}))}))})),o.promise}(Mf(t),e)}function Hp(t,e,n){var r=n.docs.get(e._key),i=new qp(t);return new wp(t,i,e._key,r,new bp(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xp=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return e(n,t),n.prototype.get=function(e){var n=this,r=Bp(e,this._firestore),i=new qp(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new wp(n._firestore,i,r._key,t._document,new bp(!1,!1),r.converter)}))},n}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=$f(t)}return t.prototype.get=function(t){var e=this,n=Bp(t,this._firestore),r=new Vp(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Ti();var i=t[0];if(i.isFoundDocument())return new vp(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new vp(e._firestore,r,n._key,null,n.converter);throw Ti()}))},t.prototype.set=function(t,e,n){var r=Bp(t,this._firestore),i=Fp(r.converter,e,n),o=Yf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Bp(t,this._firestore);return o="string"==typeof(e=T(e))||e instanceof Uf?op(this._dataReader,"Transaction.update",s._key,e,n,r):ip(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Bp(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qp(){if("undefined"==typeof Uint8Array)throw new vi(yi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wp(){if("undefined"==typeof atob)throw new vi(yi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var $p=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Wp(),new t(Bf.fromBase64String(e))},t.fromUint8Array=function(e){return Qp(),new t(Bf.fromUint8Array(e))},t.prototype.toBase64=function(){return Wp(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Qp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Yp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Vf(t=Ef(t,Lf));var n=Mf(t),r=t._freezeSettings(),i=new zh;return Ff(n,i,new qh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Vf(t=Ef(t,Lf));var e=Mf(t),n=t._freezeSettings(),r=new zh;return Ff(e,r,new Gh(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new vi(yi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new au;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return lu.yt()?(e=t+"main",[4,lu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(_c(t._databaseId,t._persistenceKey))];case 1:return o.sent(),n.resolve(),[3,3];case 2:return e=o.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Jp=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof uf||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||_i("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,r){void 0===r&&(r={}),function(t,e,r,i){var o;void 0===i&&(i={});var s=(t=Ef(t,Sf))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&_i("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:e+":"+r,ssl:!1})),i.mockUserToken){var a,u;if("string"==typeof i.mockUserToken)a=i.mockUserToken,u=Qc.MOCK_USER;else{a=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=n({iss:"https://securetoken.google.com/"+r,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")}(i.mockUserToken,null===(o=t._app)||void 0===o?void 0:o.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new vi(yi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Qc(c)}t._credentials=new ff(new lf(a,u))}}(this._delegate,t,e,r)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Zh(t)];case 1:return e=r.sent(),[4,ef(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Si(t);return e.Or.delete(0),wl(e)}(n))]}}))}))}))}(Mf(Ef(this._delegate,Lf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(o){switch(o.label){case 0:return[4,Zh(t)];case 1:return e=o.sent(),[4,ef(t)];case 2:return n=o.sent(),[2,(e.setNetworkEnabled(!1),function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=Si(t)).Or.add(0),[4,_l(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Mf(Ef(this._delegate,Lf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&mf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new au;return t.asyncQueue.enqueueAndForget((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return e=bh,[4,nf(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Mf(Ef(this._delegate,Lf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,o=new Kh(e);return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){Si(t).Gr.add(e),e.next()},[4,rf(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){Si(t).Gr.delete(e)},[4,rf(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(Mf(t=Ef(t,Lf)),Rf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new vi(yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new fd(this,Nf(this._delegate,t))}catch(t){throw id(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new rd(this,Df(this._delegate,t))}catch(t){throw id(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new cd(this,function(t,e){if(t=Ef(t,Sf),vf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new vi(yi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Af(t,null,function(t){return new jo(ji.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw id(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,o=new au;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,function(t){return Jh(t).then((function(t){return t.datastore}))}(t)];case 1:return n=r.sent(),new Xh(t.asyncQueue,n,e,o).run(),[2]}}))}))})),o.promise}(Mf(t),(function(n){return e(new Xp(t,n))}))}(this._delegate,(function(n){return t(new td(e,n))}))},t.prototype.batch=function(){var t=this;return Mf(this._delegate),new ed(new Up(this._delegate,(function(e){return Kp(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new vi(yi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new vi(yi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Zp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new $p(new Bf(t))},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return rd.eu(e,this.firestore,null)},n}(jp);var td=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Zp(t)}return t.prototype.get=function(t){var e=this,n=pd(t);return this._delegate.get(n).then((function(t){return new ad(e._firestore,new wp(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=pd(t);return n?(gf("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=pd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,a([s,e,n],i)),this},t.prototype.delete=function(t){var e=pd(t);return this._delegate.delete(e),this},t}(),ed=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=pd(t);return n?(gf("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=pd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,a([s,e,n],i)),this},t.prototype.delete=function(t){var e=pd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),nd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new _p(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ud(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Zp(e),n),i.set(n,o)),o},t}();nd.su=new WeakMap;var rd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Zp(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new vi(yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Of(n._delegate,r,new Ji(e)))},t.eu=function(e,n,r){return new t(n,new Of(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new fd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new fd(this.firestore,Nf(this._delegate,t))}catch(t){throw id(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=T(t))instanceof Of&&xf(this._delegate,t)},t.prototype.set=function(t,e){e=gf("DocumentReference.set",e);try{return function(t,e,n){t=Ef(t,Of);var r=Ef(t.firestore,Lf),i=Fp(t.converter,e,n);return Kp(r,[Yf($f(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,gs.none())])}(this._delegate,t,e)}catch(t){throw id(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Gp(this._delegate,t):Gp.apply(void 0,a([this._delegate,t,e],n))}catch(t){throw id(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Kp(Ef((t=this._delegate).firestore,Lf),[new ks(t._key,gs.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=od(e),i=sd(e,(function(e){return new ad(t.firestore,new wp(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return zp(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ef(t,Of);var e=Ef(t.firestore,Lf),n=Mf(e),o=new qp(e);return function(t,e){var n=this,o=new au;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t,e){var n=Si(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(o=i.sent()).isFoundDocument()?n.resolve(o):o.isNoDocument()?n.resolve(null):n.reject(new vi(yi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=Hl(r,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))},[4,tf(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t._key).then((function(n){return new wp(e,o,t._key,n,new bp(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Ef(t,Of);var e=Ef(t.firestore,Lf);return of(Mf(e),t._key,{source:"server"}).then((function(n){return Hp(e,t,n)}))}(this._delegate):function(t){t=Ef(t,Of);var e=Ef(t.firestore,Lf);return of(Mf(e),t._key).then((function(n){return Hp(e,t,n)}))}(this._delegate)).then((function(t){return new ad(e.firestore,new wp(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(nd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function id(t,e,n){return t.message=t.message.replace(e,n),t}function od(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Rf(r))return r}return{}}function sd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Rf(t[0])?t[0]:Rf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ad=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new rd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Ip(this._delegate,t._delegate)},t}(),ud=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(t){return this._delegate.data(t)},n}(ad),cd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Zp(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Ap(this._delegate,function(t,e,n){var r=e,i=mp("where",t);return new Cp(i,r,n)}(e,n,r)))}catch(e){throw id(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Ap(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=mp("orderBy",t);return new Np(r,n)}(e,n)))}catch(e){throw id(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Ap(this._delegate,function(t){return Tf("limit",t),new Dp("limit",t,"F")}(e)))}catch(e){throw id(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Ap(this._delegate,function(t){return Tf("limitToLast",t),new Dp("limitToLast",t,"L")}(e)))}catch(e){throw id(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw id(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw id(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw id(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw id(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return kf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ef(t,Af);var e=Ef(t.firestore,Lf),n=Mf(e),o=new qp(e);return function(t,e){var n=this,o=new au;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Rc(t,e,!0)];case 1:return u=i.sent(),r=new sh(e,u.Bn),o=r._o(u.documents),s=r.applyChanges(o,!1),n.resolve(s.snapshot),[3,3];case 2:return a=i.sent(),u=Hl(a,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,tf(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t._query).then((function(n){return new Ep(e,o,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Ef(t,Af);var e=Ef(t.firestore,Lf),n=Mf(e),r=new qp(e);return sf(n,t._query,{source:"server"}).then((function(n){return new Ep(e,r,t,n)}))}(this._delegate):function(t){t=Ef(t,Af);var e=Ef(t.firestore,Lf),n=Mf(e),r=new qp(e);return Sp(t._query),sf(n,t._query).then((function(n){return new Ep(e,r,t,n)}))}(this._delegate)).then((function(t){return new hd(e.firestore,new Ep(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=od(e),i=sd(e,(function(e){return new hd(t.firestore,new Ep(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return zp(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(nd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),ld=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new ud(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),hd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new cd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new ud(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new ld(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new ud(n._firestore,r))}))},t.prototype.isEqual=function(t){return Ip(this._delegate,t._delegate)},t}(),fd=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new rd(this.firestore,t):null},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){try{return new rd(this.firestore,void 0===t?Df(this._delegate):Df(this._delegate,t))}catch(t){throw id(t,"doc()","CollectionReference.doc()")}},n.prototype.add=function(t){var e=this;return function(t,e){var n=Ef(t.firestore,Lf),r=Df(t),i=Fp(t.converter,e);return Kp(n,[Yf($f(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,gs.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new rd(e.firestore,t)}))},n.prototype.isEqual=function(t){return xf(this._delegate,t._delegate)},n.prototype.withConverter=function(t){return new n(this.firestore,t?this._delegate.withConverter(nd.nu(this.firestore,t)):this._delegate.withConverter(null))},n}(cd);function pd(t){return Ef(t,Of)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dd,yd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Uf.bind.apply(Uf,a([void 0],t)))}return t.documentId=function(){return new t(Vi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=T(t))instanceof Uf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),vd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new tp("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Jf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ep("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new np("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new rp("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),gd={Firestore:Jp,GeoPoint:Gf,Timestamp:xi,Blob:$p,Transaction:td,WriteBatch:ed,DocumentReference:rd,DocumentSnapshot:ad,Query:cd,QueryDocumentSnapshot:ud,QuerySnapshot:hd,CollectionReference:fd,FieldPath:yd,FieldValue:vd,setLogLevel:function(t){var e;e=t,gi.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new I("firestore",(function(t){return function(t,e){return new Jp(t,new Lf(t,e),new Yp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},gd)))})(dd=J),dd.registerVersion("@firebase/firestore","2.4.0");J.initializeApp({apiKey:"AIzaSyDjSSoXs-xNIyq310lsCzVcYu8Zz9puiPQ",authDomain:"tag-generator-3.firebaseapp.com",projectId:"tag-generator-3",storageBucket:"tag-generator-3.appspot.com",messagingSenderId:"25589238377",appId:"1:25589238377:web:b089f263d21e9b18d330f8"});const md="start",bd="count",wd="template",_d="age",Ed="gender",Td="category",Id="size",Sd="style",Od="quality";var Ad={},Cd={},Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.default=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.text=n.text||e,this.options=n},Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.CODE39=void 0;var Dd,xd=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var kd=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t.toUpperCase(),n.mod43&&(t+=function(t){return Pd[t]}(function(t){for(var e=0,n=0;n<t.length;n++)e+=Md(t[n]);return e%=43}(t))),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),xd(e,[{key:"encode",value:function(){for(var t=Ld("*"),e=0;e<this.data.length;e++)t+=Ld(this.data[e])+"0";return{data:t+=Ld("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),e}(((Dd=Nd)&&Dd.__esModule?Dd:{default:Dd}).default),Pd=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],Rd=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function Ld(t){return function(t){return Rd[t].toString(2)}(Md(t))}function Md(t){return Pd.indexOf(t)}Cd.CODE39=kd;var jd,Fd={},Vd={},Ud={},Bd={};function qd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Bd,"__esModule",{value:!0});var Gd=Bd.SET_A=0,zd=Bd.SET_B=1,Kd=Bd.SET_C=2;Bd.SHIFT=98;var Hd=Bd.START_A=103,Xd=Bd.START_B=104,Qd=Bd.START_C=105;Bd.MODULO=103,Bd.STOP=106,Bd.FNC1=207,Bd.SET_BY_CODE=(qd(jd={},Hd,Gd),qd(jd,Xd,zd),qd(jd,Qd,Kd),jd),Bd.SWAP={101:Gd,100:zd,99:Kd},Bd.A_START_CHAR=String.fromCharCode(208),Bd.B_START_CHAR=String.fromCharCode(209),Bd.C_START_CHAR=String.fromCharCode(210),Bd.A_CHARS="[\0-_È-Ï]",Bd.B_CHARS="[ -È-Ï]",Bd.C_CHARS="(Ï*[0-9]{2}Ï*)",Bd.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],Object.defineProperty(Ud,"__esModule",{value:!0});var Wd=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),$d=function(t){return t&&t.__esModule?t:{default:t}}(Nd),Yd=Bd;var Jd=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),n));return r.bytes=t.split("").map((function(t){return t.charCodeAt(0)})),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Wd(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,n=t.shift()-105,r=Yd.SET_BY_CODE[n];if(void 0===r)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&t.unshift(Yd.FNC1);var i=e.next(t,1,r);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(n)+i.result+e.getBar((i.checksum+n)%Yd.MODULO)+e.getBar(Yd.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var t=this.options.ean128||!1;return"string"==typeof t&&(t="true"===t.toLowerCase()),t}}],[{key:"getBar",value:function(t){return Yd.BARS[t]?Yd.BARS[t].toString():""}},{key:"correctIndex",value:function(t,e){if(e===Yd.SET_A){var n=t.shift();return n<32?n+64:n-32}return e===Yd.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,n,r){if(!t.length)return{result:"",checksum:0};var i=void 0,o=void 0;if(t[0]>=200){o=t.shift()-105;var s=Yd.SWAP[o];void 0!==s?i=e.next(t,n+1,s):(r!==Yd.SET_A&&r!==Yd.SET_B||o!==Yd.SHIFT||(t[0]=r===Yd.SET_A?t[0]>95?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),i=e.next(t,n+1,r))}else o=e.correctIndex(t,r),i=e.next(t,n+1,r);var a=o*n;return{result:e.getBar(o)+i.result,checksum:a+i.checksum}}}]),e}($d.default);Ud.default=Jd;var Zd={};Object.defineProperty(Zd,"__esModule",{value:!0});var ty=Bd,ey=function(t){return t.match(new RegExp("^"+ty.A_CHARS+"*"))[0].length},ny=function(t){return t.match(new RegExp("^"+ty.B_CHARS+"*"))[0].length},ry=function(t){return t.match(new RegExp("^"+ty.C_CHARS+"*"))[0]};function iy(t,e){var n=e?ty.A_CHARS:ty.B_CHARS,r=t.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(r)return r[1]+String.fromCharCode(204)+oy(t.substring(r[1].length));var i=t.match(new RegExp("^"+n+"+"))[0];return i.length===t.length?t:i+String.fromCharCode(e?205:206)+iy(t.substring(i.length),!e)}function oy(t){var e=ry(t),n=e.length;if(n===t.length)return t;t=t.substring(n);var r=ey(t)>=ny(t);return e+String.fromCharCode(r?206:205)+iy(t,r)}Zd.default=function(t){var e=void 0;if(ry(t).length>=2)e=ty.C_START_CHAR+oy(t);else{var n=ey(t)>ny(t);e=(n?ty.A_START_CHAR:ty.B_START_CHAR)+iy(t,n)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(t,e){return String.fromCharCode(203)+e}))},Object.defineProperty(Vd,"__esModule",{value:!0});var sy=uy(Ud),ay=uy(Zd);function uy(t){return t&&t.__esModule?t:{default:t}}function cy(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var ly=function(t){function e(t,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var r=cy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,ay.default)(t),n));else r=cy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return cy(r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(sy.default);Vd.default=ly;var hy={};Object.defineProperty(hy,"__esModule",{value:!0});var fy=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),py=function(t){return t&&t.__esModule?t:{default:t}}(Ud),dy=Bd;var yy=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,dy.A_START_CHAR+t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),fy(e,[{key:"valid",value:function(){return new RegExp("^"+dy.A_CHARS+"+$").test(this.data)}}]),e}(py.default);hy.default=yy;var vy={};Object.defineProperty(vy,"__esModule",{value:!0});var gy=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),my=function(t){return t&&t.__esModule?t:{default:t}}(Ud),by=Bd;var wy=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,by.B_START_CHAR+t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),gy(e,[{key:"valid",value:function(){return new RegExp("^"+by.B_CHARS+"+$").test(this.data)}}]),e}(my.default);vy.default=wy;var _y={};Object.defineProperty(_y,"__esModule",{value:!0});var Ey=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Ty=function(t){return t&&t.__esModule?t:{default:t}}(Ud),Iy=Bd;var Sy=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Iy.C_START_CHAR+t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Ey(e,[{key:"valid",value:function(){return new RegExp("^"+Iy.C_CHARS+"+$").test(this.data)}}]),e}(Ty.default);_y.default=Sy,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.CODE128C=Fd.CODE128B=Fd.CODE128A=Fd.CODE128=void 0;var Oy=Dy(Vd),Ay=Dy(hy),Cy=Dy(vy),Ny=Dy(_y);function Dy(t){return t&&t.__esModule?t:{default:t}}Fd.CODE128=Oy.default,Fd.CODE128A=Ay.default,Fd.CODE128B=Cy.default,Fd.CODE128C=Ny.default;var xy={},ky={},Py={};Object.defineProperty(Py,"__esModule",{value:!0}),Py.SIDE_BIN="101",Py.MIDDLE_BIN="01010",Py.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},Py.EAN2_STRUCTURE=["LL","LG","GL","GG"],Py.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],Py.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];var Ry={},Ly={};Object.defineProperty(Ly,"__esModule",{value:!0});var My=Py;Ly.default=function(t,e,n){var r=t.split("").map((function(t,n){return My.BINARIES[e[n]]})).map((function(e,n){return e?e[t[n]]:""}));if(n){var i=t.length-1;r=r.map((function(t,e){return e<i?t+n:t}))}return r.join("")},Object.defineProperty(Ry,"__esModule",{value:!0});var jy=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Fy=Py,Vy=Uy(Ly);function Uy(t){return t&&t.__esModule?t:{default:t}}var By=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.fontSize=!n.flat&&n.fontSize>10*n.width?10*n.width:n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),jy(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(t,e){return this.text.substr(t,e)}},{key:"leftEncode",value:function(t,e){return(0,Vy.default)(t,e)}},{key:"rightText",value:function(t,e){return this.text.substr(t,e)}},{key:"rightEncode",value:function(t,e){return(0,Vy.default)(t,e)}},{key:"encodeGuarded",value:function(){var t={fontSize:this.fontSize},e={height:this.guardHeight};return[{data:Fy.SIDE_BIN,options:e},{data:this.leftEncode(),text:this.leftText(),options:t},{data:Fy.MIDDLE_BIN,options:e},{data:this.rightEncode(),text:this.rightText(),options:t},{data:Fy.SIDE_BIN,options:e}]}},{key:"encodeFlat",value:function(){return{data:[Fy.SIDE_BIN,this.leftEncode(),Fy.MIDDLE_BIN,this.rightEncode(),Fy.SIDE_BIN].join(""),text:this.text}}}]),e}(Uy(Nd).default);Ry.default=By,Object.defineProperty(ky,"__esModule",{value:!0});var qy=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Gy=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},zy=Py,Ky=function(t){return t&&t.__esModule?t:{default:t}}(Ry);var Hy=function(t){return(10-t.substr(0,12).split("").map((function(t){return+t})).reduce((function(t,e,n){return n%2?t+3*e:t+e}),0)%10)%10},Xy=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{12}$/)&&(t+=Hy(t));var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.lastChar=n.lastChar,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),qy(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===Hy(this.data)}},{key:"leftText",value:function(){return Gy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var t=this.data.substr(1,6),n=zy.EAN13_STRUCTURE[this.data[0]];return Gy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,n)}},{key:"rightText",value:function(){return Gy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var t=this.data.substr(7,6);return Gy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRRRR")}},{key:"encodeGuarded",value:function(){var t=Gy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(t.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(t.push({data:"00"}),t.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),t}}]),e}(Ky.default);ky.default=Xy;var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0});var Wy=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),$y=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},Yy=function(t){return t&&t.__esModule?t:{default:t}}(Ry);var Jy=function(t){return(10-t.substr(0,7).split("").map((function(t){return+t})).reduce((function(t,e,n){return n%2?t+e:t+3*e}),0)%10)%10},Zy=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{7}$/)&&(t+=Jy(t)),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Wy(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===Jy(this.data)}},{key:"leftText",value:function(){return $y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var t=this.data.substr(0,4);return $y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,"LLLL")}},{key:"rightText",value:function(){return $y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var t=this.data.substr(4,4);return $y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRR")}}]),e}(Yy.default);Qy.default=Zy;var tv={};Object.defineProperty(tv,"__esModule",{value:!0});var ev=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),nv=Py,rv=ov(Ly),iv=ov(Nd);function ov(t){return t&&t.__esModule?t:{default:t}}var sv=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),ev(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var t,e=nv.EAN5_STRUCTURE[(t=this.data,t.split("").map((function(t){return+t})).reduce((function(t,e,n){return n%2?t+9*e:t+3*e}),0)%10)];return{data:"1011"+(0,rv.default)(this.data,e,"01"),text:this.text}}}]),e}(iv.default);tv.default=sv;var av={};Object.defineProperty(av,"__esModule",{value:!0});var uv=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),cv=Py,lv=hv(Ly);function hv(t){return t&&t.__esModule?t:{default:t}}var fv=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),uv(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var t=cv.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,lv.default)(this.data,t,"01"),text:this.text}}}]),e}(hv(Nd).default);av.default=fv;var pv={};Object.defineProperty(pv,"__esModule",{value:!0});var dv=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();pv.checksum=mv;var yv=vv(Ly);function vv(t){return t&&t.__esModule?t:{default:t}}var gv=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{11}$/)&&(t+=mv(t));var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),dv(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==mv(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=(0,yv.default)(this.data.substr(0,6),"LLLLLL"),t+="01010",t+=(0,yv.default)(this.data.substr(6,6),"RRRRRR"),{data:t+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101"+(0,yv.default)(this.data[0],"L"),options:{height:this.guardHeight}}),t.push({data:(0,yv.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),t.push({data:"01010",options:{height:this.guardHeight}}),t.push({data:(0,yv.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),t.push({data:(0,yv.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),t}}]),e}(vv(Nd).default);function mv(t){var e,n=0;for(e=1;e<11;e+=2)n+=parseInt(t[e]);for(e=0;e<11;e+=2)n+=3*parseInt(t[e]);return(10-n%10)%10}pv.default=gv;var bv={};Object.defineProperty(bv,"__esModule",{value:!0});var wv=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_v=Iv(Ly),Ev=Iv(Nd),Tv=pv;function Iv(t){return t&&t.__esModule?t:{default:t}}function Sv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var Ov=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],Av=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],Cv=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Sv(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(r.isValid=!1,-1!==t.search(/^[0-9]{6}$/))r.middleDigits=t,r.upcA=Nv(t,"0"),r.text=n.text||""+r.upcA[0]+t+r.upcA[r.upcA.length-1],r.isValid=!0;else{if(-1===t.search(/^[01][0-9]{7}$/))return Sv(r);if(r.middleDigits=t.substring(1,t.length-1),r.upcA=Nv(r.middleDigits,t[0]),r.upcA[r.upcA.length-1]!==t[t.length-1])return Sv(r);r.isValid=!0}return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),wv(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=this.encodeMiddleDigits(),{data:t+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101",options:{height:this.guardHeight}}),t.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),t.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),t}},{key:"encodeMiddleDigits",value:function(){var t=this.upcA[0],e=this.upcA[this.upcA.length-1],n=Av[parseInt(e)][parseInt(t)];return(0,_v.default)(this.middleDigits,n)}}]),e}(Ev.default);function Nv(t,e){for(var n=parseInt(t[t.length-1]),r=Ov[n],i="",o=0,s=0;s<r.length;s++){var a=r[s];i+="X"===a?t[o++]:a}return""+(i=""+e+i)+(0,Tv.checksum)(i)}bv.default=Cv,Object.defineProperty(xy,"__esModule",{value:!0}),xy.UPCE=xy.UPC=xy.EAN2=xy.EAN5=xy.EAN8=xy.EAN13=void 0;var Dv=Mv(ky),xv=Mv(Qy),kv=Mv(tv),Pv=Mv(av),Rv=Mv(pv),Lv=Mv(bv);function Mv(t){return t&&t.__esModule?t:{default:t}}xy.EAN13=Dv.default,xy.EAN8=xv.default,xy.EAN5=kv.default,xy.EAN2=Pv.default,xy.UPC=Rv.default,xy.UPCE=Lv.default;var jv={},Fv={},Vv={};Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.START_BIN="1010",Vv.END_BIN="11101",Vv.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"],Object.defineProperty(Fv,"__esModule",{value:!0});var Uv=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Bv=Vv;function qv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var zv=function(t){function e(){return qv(this,e),Gv(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Uv(e,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var t=this,e=this.data.match(/.{2}/g).map((function(e){return t.encodePair(e)})).join("");return{data:Bv.START_BIN+e+Bv.END_BIN,text:this.text}}},{key:"encodePair",value:function(t){var e=Bv.BINARIES[t[1]];return Bv.BINARIES[t[0]].split("").map((function(t,n){return("1"===t?"111":"1")+("1"===e[n]?"000":"0")})).join("")}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(Nd).default);Fv.default=zv;var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});var Hv=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Xv=function(t){return t&&t.__esModule?t:{default:t}}(Fv);var Qv=function(t){var e=t.substr(0,13).split("").map((function(t){return parseInt(t,10)})).reduce((function(t,e,n){return t+e*(3-n%2*2)}),0);return 10*Math.ceil(e/10)-e},Wv=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{13}$/)&&(t+=Qv(t)),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Hv(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===Qv(this.data)}}]),e}(Xv.default);Kv.default=Wv,Object.defineProperty(jv,"__esModule",{value:!0}),jv.ITF14=jv.ITF=void 0;var $v=Jv(Fv),Yv=Jv(Kv);function Jv(t){return t&&t.__esModule?t:{default:t}}jv.ITF=$v.default,jv.ITF14=Yv.default;var Zv={},tg={};Object.defineProperty(tg,"__esModule",{value:!0});var eg=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var ng=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),eg(e,[{key:"encode",value:function(){for(var t="110",e=0;e<this.data.length;e++){var n=parseInt(this.data[e]).toString(2);n=rg(n,4-n.length);for(var r=0;r<n.length;r++)t+="0"==n[r]?"100":"110"}return{data:t+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(Nd).default);function rg(t,e){for(var n=0;n<e;n++)t="0"+t;return t}tg.default=ng;var ig={},og={};Object.defineProperty(og,"__esModule",{value:!0}),og.mod10=function(t){for(var e=0,n=0;n<t.length;n++){var r=parseInt(t[n]);(n+t.length)%2==0?e+=r:e+=2*r%10+Math.floor(2*r/10)}return(10-e%10)%10},og.mod11=function(t){for(var e=0,n=[2,3,4,5,6,7],r=0;r<t.length;r++){var i=parseInt(t[t.length-1-r]);e+=n[r%n.length]*i}return(11-e%11)%11},Object.defineProperty(ig,"__esModule",{value:!0});var sg=function(t){return t&&t.__esModule?t:{default:t}}(tg),ag=og;var ug=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,ag.mod10)(t),n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(sg.default);ig.default=ug;var cg={};Object.defineProperty(cg,"__esModule",{value:!0});var lg=function(t){return t&&t.__esModule?t:{default:t}}(tg),hg=og;var fg=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,hg.mod11)(t),n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(lg.default);cg.default=fg;var pg={};Object.defineProperty(pg,"__esModule",{value:!0});var dg=function(t){return t&&t.__esModule?t:{default:t}}(tg),yg=og;var vg=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,yg.mod10)(t),t+=(0,yg.mod10)(t),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(dg.default);pg.default=vg;var gg={};Object.defineProperty(gg,"__esModule",{value:!0});var mg=function(t){return t&&t.__esModule?t:{default:t}}(tg),bg=og;var wg=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,bg.mod11)(t),t+=(0,bg.mod10)(t),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(mg.default);gg.default=wg,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.MSI1110=Zv.MSI1010=Zv.MSI11=Zv.MSI10=Zv.MSI=void 0;var _g=Og(tg),Eg=Og(ig),Tg=Og(cg),Ig=Og(pg),Sg=Og(gg);function Og(t){return t&&t.__esModule?t:{default:t}}Zv.MSI=_g.default,Zv.MSI10=Eg.default,Zv.MSI11=Tg.default,Zv.MSI1010=Ig.default,Zv.MSI1110=Sg.default;var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.pharmacode=void 0;var Cg=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ng=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.number=parseInt(t,10),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Cg(e,[{key:"encode",value:function(){for(var t=this.number,e="";!isNaN(t)&&0!=t;)t%2==0?(e="11100"+e,t=(t-2)/2):(e="100"+e,t=(t-1)/2);return{data:e=e.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(Nd).default);Ag.pharmacode=Ng;var Dg={};Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.codabar=void 0;var xg=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var kg=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),0===t.search(/^[0-9\-\$\:\.\+\/]+$/)&&(t="A"+t+"A");var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),n));return r.text=r.options.text||r.text.replace(/[A-D]/g,""),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),xg(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var t=[],e=this.getEncodings(),n=0;n<this.data.length;n++)t.push(e[this.data.charAt(n)]),n!==this.data.length-1&&t.push("0");return{text:this.text,data:t.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"101100110011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(Nd).default);Dg.codabar=kg;var Pg={};Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.GenericBarcode=void 0;var Rg=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Lg=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Rg(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(Nd).default);Pg.GenericBarcode=Lg,Object.defineProperty(Ad,"__esModule",{value:!0});var Mg=Cd,jg=Fd,Fg=xy,Vg=jv,Ug=Zv,Bg=Ag,qg=Dg,Gg=Pg;Ad.default={CODE39:Mg.CODE39,CODE128:jg.CODE128,CODE128A:jg.CODE128A,CODE128B:jg.CODE128B,CODE128C:jg.CODE128C,EAN13:Fg.EAN13,EAN8:Fg.EAN8,EAN5:Fg.EAN5,EAN2:Fg.EAN2,UPC:Fg.UPC,UPCE:Fg.UPCE,ITF14:Vg.ITF14,ITF:Vg.ITF,MSI:Ug.MSI,MSI10:Ug.MSI10,MSI11:Ug.MSI11,MSI1010:Ug.MSI1010,MSI1110:Ug.MSI1110,pharmacode:Bg.pharmacode,codabar:qg.codabar,GenericBarcode:Gg.GenericBarcode};var zg={};Object.defineProperty(zg,"__esModule",{value:!0});var Kg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};zg.default=function(t,e){return Kg({},t,e)};var Hg={};Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.default=function(t){var e=[];return function t(n){if(Array.isArray(n))for(var r=0;r<n.length;r++)t(n[r]);else n.text=n.text||"",n.data=n.data||"",e.push(n)}(t),e};var Xg={};Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.default=function(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t};var Qg={},Wg={},$g={};Object.defineProperty($g,"__esModule",{value:!0}),$g.default=function(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in e)e.hasOwnProperty(n)&&(n=e[n],"string"==typeof t[n]&&(t[n]=parseInt(t[n],10)));"string"==typeof t.displayValue&&(t.displayValue="false"!=t.displayValue);return t};var Yg={};Object.defineProperty(Yg,"__esModule",{value:!0});var Jg={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};Yg.default=Jg,Object.defineProperty(Wg,"__esModule",{value:!0});var Zg=em($g),tm=em(Yg);function em(t){return t&&t.__esModule?t:{default:t}}Wg.default=function(t){var e={};for(var n in tm.default)tm.default.hasOwnProperty(n)&&(t.hasAttribute("jsbarcode-"+n.toLowerCase())&&(e[n]=t.getAttribute("jsbarcode-"+n.toLowerCase())),t.hasAttribute("data-"+n.toLowerCase())&&(e[n]=t.getAttribute("data-"+n.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),e=(0,Zg.default)(e)};var nm={},rm={},im={};Object.defineProperty(im,"__esModule",{value:!0}),im.getTotalWidthOfEncodings=im.calculateEncodingAttributes=im.getBarcodePadding=im.getEncodingHeight=im.getMaximumHeightOfEncodings=void 0;var om=function(t){return t&&t.__esModule?t:{default:t}}(zg);function sm(t,e){return e.height+(e.displayValue&&t.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function am(t,e,n){if(n.displayValue&&e<t){if("center"==n.textAlign)return Math.floor((t-e)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(t-e)}return 0}function um(t,e,n){var r;if(n)r=n;else{if("undefined"==typeof document)return 0;r=document.createElement("canvas").getContext("2d")}r.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var i=r.measureText(t);return i?i.width:0}im.getMaximumHeightOfEncodings=function(t){for(var e=0,n=0;n<t.length;n++)t[n].height>e&&(e=t[n].height);return e},im.getEncodingHeight=sm,im.getBarcodePadding=am,im.calculateEncodingAttributes=function(t,e,n){for(var r=0;r<t.length;r++){var i,o=t[r],s=(0,om.default)(e,o.options);i=s.displayValue?um(o.text,s,n):0;var a=o.data.length*s.width;o.width=Math.ceil(Math.max(i,a)),o.height=sm(o,s),o.barcodePadding=am(i,a,s)}},im.getTotalWidthOfEncodings=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].width;return e},Object.defineProperty(rm,"__esModule",{value:!0});var cm=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),lm=function(t){return t&&t.__esModule?t:{default:t}}(zg),hm=im;var fm=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.encodings=n,this.options=r}return cm(t,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,lm.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,hm.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,hm.getTotalWidthOfEncodings)(this.encodings),n=(0,hm.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var n,r=this.canvas.getContext("2d"),i=e.data;n="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,r.fillStyle=t.lineColor;for(var o=0;o<i.length;o++){var s=o*t.width+e.barcodePadding;"1"===i[o]?r.fillRect(s,n,t.width,t.height):i[o]&&r.fillRect(s,n,t.width,t.height*i[o])}}},{key:"drawCanvasText",value:function(t,e){var n,r,i=this.canvas.getContext("2d"),o=t.fontOptions+" "+t.fontSize+"px "+t.font;t.displayValue&&(r="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,i.font=o,"left"==t.textAlign||e.barcodePadding>0?(n=0,i.textAlign="left"):"right"==t.textAlign?(n=e.width-1,i.textAlign="right"):(n=e.width/2,i.textAlign="center"),i.fillText(e.text,n,r))}},{key:"moveCanvasDrawing",value:function(t){this.canvas.getContext("2d").translate(t.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),t}();rm.default=fm;var pm={};Object.defineProperty(pm,"__esModule",{value:!0});var dm=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),ym=function(t){return t&&t.__esModule?t:{default:t}}(zg),vm=im;var gm="http://www.w3.org/2000/svg",mm=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svg=e,this.encodings=n,this.options=r,this.document=r.xmlDocument||document}return dm(t,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var n=this.encodings[e],r=(0,ym.default)(this.options,n.options),i=this.createGroup(t,r.marginTop,this.svg);this.setGroupOptions(i,r),this.drawSvgBarcode(i,r,n),this.drawSVGText(i,r,n),t+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,vm.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,vm.getTotalWidthOfEncodings)(this.encodings),e=(0,vm.getMaximumHeightOfEncodings)(this.encodings),n=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,e),this.options.background&&this.drawRect(0,0,n,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,n){var r,i=n.data;r="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var o=0,s=0,a=0;a<i.length;a++)s=a*e.width+n.barcodePadding,"1"===i[a]?o++:o>0&&(this.drawRect(s-e.width*o,r,e.width*o,e.height,t),o=0);o>0&&this.drawRect(s-e.width*(o-1),r,e.width*o,e.height,t)}},{key:"drawSVGText",value:function(t,e,n){var r,i,o=this.document.createElementNS(gm,"text");e.displayValue&&(o.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),i="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||n.barcodePadding>0?(r=0,o.setAttribute("text-anchor","start")):"right"==e.textAlign?(r=n.width-1,o.setAttribute("text-anchor","end")):(r=n.width/2,o.setAttribute("text-anchor","middle")),o.setAttribute("x",r),o.setAttribute("y",i),o.appendChild(this.document.createTextNode(n.text)),t.appendChild(o))}},{key:"setSvgAttributes",value:function(t,e){var n=this.svg;n.setAttribute("width",t+"px"),n.setAttribute("height",e+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+t+" "+e),n.setAttribute("xmlns",gm),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,n){var r=this.document.createElementNS(gm,"g");return r.setAttribute("transform","translate("+t+", "+e+")"),n.appendChild(r),r}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,n,r,i){var o=this.document.createElementNS(gm,"rect");return o.setAttribute("x",t),o.setAttribute("y",e),o.setAttribute("width",n),o.setAttribute("height",r),i.appendChild(o),o}}]),t}();pm.default=mm;var bm={};Object.defineProperty(bm,"__esModule",{value:!0});var wm=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var _m=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.object=e,this.encodings=n,this.options=r}return wm(t,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),t}();bm.default=_m,Object.defineProperty(nm,"__esModule",{value:!0});var Em=Sm(rm),Tm=Sm(pm),Im=Sm(bm);function Sm(t){return t&&t.__esModule?t:{default:t}}nm.default={CanvasRenderer:Em.default,SVGRenderer:Tm.default,ObjectRenderer:Im.default};var Om={};function Am(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cm(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Nm(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(Om,"__esModule",{value:!0});var Dm=function(t){function e(t,n){Am(this,e);var r=Cm(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.name="InvalidInputException",r.symbology=t,r.input=n,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return Nm(e,Error),e}(),xm=function(t){function e(){Am(this,e);var t=Cm(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return Nm(e,Error),e}(),km=function(t){function e(){Am(this,e);var t=Cm(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return Nm(e,Error),e}();Om.InvalidInputException=Dm,Om.InvalidElementException=xm,Om.NoElementException=km,Object.defineProperty(Qg,"__esModule",{value:!0});var Pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rm=jm(Wg),Lm=jm(nm),Mm=Om;function jm(t){return t&&t.__esModule?t:{default:t}}function Fm(t){if("string"==typeof t)return function(t){var e=document.querySelectorAll(t);if(0===e.length)return;for(var n=[],r=0;r<e.length;r++)n.push(Fm(e[r]));return n}(t);if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(Fm(t[n]));return e}if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return function(t){var e=document.createElement("canvas");return{element:e,options:(0,Rm.default)(t),renderer:Lm.default.CanvasRenderer,afterRender:function(){t.setAttribute("src",e.toDataURL())}}}(t);if(t&&t.nodeName&&"svg"===t.nodeName.toLowerCase()||"undefined"!=typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,Rm.default)(t),renderer:Lm.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,Rm.default)(t),renderer:Lm.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:Lm.default.CanvasRenderer};if(t&&"object"===(void 0===t?"undefined":Pm(t))&&!t.nodeName)return{element:t,renderer:Lm.default.ObjectRenderer};throw new Mm.InvalidElementException}Qg.default=Fm;var Vm={};Object.defineProperty(Vm,"__esModule",{value:!0});var Um=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Bm=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.api=e}return Um(t,[{key:"handleCatch",value:function(t){if("InvalidInputException"!==t.name)throw t;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(t){return this.handleCatch(t),this.api}}}]),t}();Vm.default=Bm;var qm=Ym(Ad),Gm=Ym(zg),zm=Ym(Hg),Km=Ym(Xg),Hm=Ym(Qg),Xm=Ym($g),Qm=Ym(Vm),Wm=Om,$m=Ym(Yg);function Ym(t){return t&&t.__esModule?t:{default:t}}var Jm=function(){},Zm=function(t,e,n){var r=new Jm;if(void 0===t)throw Error("No element to render on was provided.");return r._renderProperties=(0,Hm.default)(t),r._encodings=[],r._options=$m.default,r._errorHandler=new Qm.default(r),void 0!==e&&((n=n||{}).format||(n.format=rb()),r.options(n)[n.format](e,n).render()),r};for(var tb in Zm.getModule=function(t){return qm.default[t]},qm.default)qm.default.hasOwnProperty(tb)&&eb(qm.default,tb);function eb(t,e){Jm.prototype[e]=Jm.prototype[e.toUpperCase()]=Jm.prototype[e.toLowerCase()]=function(n,r){var i=this;return i._errorHandler.wrapBarcodeCall((function(){r.text=void 0===r.text?void 0:""+r.text;var o=(0,Gm.default)(i._options,r);o=(0,Xm.default)(o);var s=t[e],a=nb(n,s,o);return i._encodings.push(a),i}))}}function nb(t,e,n){var r=new e(t=""+t,n);if(!r.valid())throw new Wm.InvalidInputException(r.constructor.name,t);var i=r.encode();i=(0,zm.default)(i);for(var o=0;o<i.length;o++)i[o].options=(0,Gm.default)(n,i[o].options);return i}function rb(){return qm.default.CODE128?"CODE128":Object.keys(qm.default)[0]}function ib(t,e,n){e=(0,zm.default)(e);for(var r=0;r<e.length;r++)e[r].options=(0,Gm.default)(n,e[r].options),(0,Km.default)(e[r].options);(0,Km.default)(n),new(0,t.renderer)(t.element,e,n).render(),t.afterRender&&t.afterRender()}Jm.prototype.options=function(t){return this._options=(0,Gm.default)(this._options,t),this},Jm.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},Jm.prototype.init=function(){var t;if(this._renderProperties)for(var e in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){t=this._renderProperties[e];var n=(0,Gm.default)(this._options,t.options);"auto"==n.format&&(n.format=rb()),this._errorHandler.wrapBarcodeCall((function(){var e=nb(n.value,qm.default[n.format.toUpperCase()],n);ib(t,e,n)}))}},Jm.prototype.render=function(){if(!this._renderProperties)throw new Wm.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)ib(this._renderProperties[t],this._encodings,this._options);else ib(this._renderProperties,this._encodings,this._options);return this},Jm.prototype._defaults=$m.default,"undefined"!=typeof window&&(window.JsBarcode=Zm),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var n=[];return jQuery(this).each((function(){n.push(this)})),Zm(n,t,e)});var ob=Zm;const sb={adult:"Взрослое",kid:"Детское",baby:"Младенческое"},ab={male:"Мужское",female:"Женское",universal:"Универсальная"},ub={F:"Ф (футболки, майки, блузы, топы)",S:"С (свитеры, олимпийки, кардиганы)",B:"Б (брюки, джинсы и шорты)",D:"Д (домашняя одежда, ночнушки, халаты и т.д.)",P:"П (платья и сарафаны)",U:"Ю (юбки)",G:"Г (головные уборы)",V:"В (верхняя одежда)",R:"Р (рубашки)",BK:"БК (боди)",BM:"Б (штанишки, шорты и ползунки)",SM:"С (свитеры, распашонки, кофточки, жакеты, джемперы)"},cb={adult:{male:{XS:"XS (< 44)",S:"S (44)",M:"M (46-48)",L:"L (50-52)",XL:"XL (54-56)",XXL:"XXL (58-62)",XXXL:"XXXL+ (64+)"},female:{XS:"XS (< 38)",S:"S (40-42)",M:"M (44-46)",L:"L (48-50)",XL:"XL (52-54)",XXL:"XXL (56)",XXXL:"XXXL+ (58+)"}},kid:{male:{XS:"50-62",S:"68-86",M:"92-110",L:"116-128",XL:"134-140",XXL:"146-152",XXXL:"158+"},female:{XS:"50-62",S:"68-86",M:"92-110",L:"116-128",XL:"134-140",XXL:"146-152",XXXL:"158+"}}},lb={neutral:"1",bright:"2",expressive:"3"},hb={low:"3",middle:"2",high:"1"};async function fb(){let t=document.querySelector("#template")?.value||"#female-male",e=parseInt(document.querySelector("#start")?.value||"0"),n=parseInt(document.querySelector("#count")?.value||"12"),r=pb(Ed),i=pb(Td),o=pb(Id),s=pb(Od),a=pb(Sd),u=pb(_d);if(!(r&&i&&o&&s&&a&&u))return void alert("Не все поля заполнены!");document.querySelector("#generate").disabled=!0;let c={start:e,end:e+n-1,template:t,userId:"x",userName:"x",gender:r,category:i,size:o,quality:s,style:a,age:u};try{await async function(t){let e=J.firestore().doc("generation/latest");if((await J.firestore().doc("generation/latest").get()).get("end")>t.end)throw Error("Выделенные номера уже заняты. Пожалуйста, обновите страницу и попробуйте снова.");await e.set(t);let n=J.firestore().collection("generation").doc();await n.set(t)}(c);window.open(location.pathname+`?start=${e}&count=${n}`+`&template=${encodeURIComponent(t)}`+`&gender=${r}`+`&category=${i}`+`&size=${o}`+`&style=${a}`+`&age=${u}`+`&quality=${s}`,"Print","width=1000,height=800,left=300,top=200")}catch(t){alert(t.message)}document.querySelector("#start").value=(c.end+1).toString(),document.querySelector("#generate").disabled=!1}function pb(t){for(var e=document.getElementsByName(t),n=0;n<e.length;n++){let t=e[n];if(t.checked)return t.value}}function db(){const t=new URLSearchParams(window.location.search),e=t.get(md),n=t.get(bd),r=t.get(wd),i=t.get(_d),o=t.get(Ed),s=t.get(Td),a=t.get(Id),u=t.get(Sd),c=t.get(Od);return!!(e&&n&&r)&&(function(t,e,n,r){document.querySelector("#settings").style.display="none",document.querySelector("#loading").style.display="none";let i=document.querySelector("#print"),o=document.querySelector(t);if(o){for(let t=e;t<e+n;t++){let e=document.importNode(o.content,!0),n=e.querySelector(".code");ob(n).options({height:70,fontSize:25}).CODE128(t.toString(),{}).render(),e.querySelector("#ageValue").textContent=sb[r.age],e.querySelector("#genderValue").textContent=ab[r.gender],e.querySelector("#categoryValue").textContent=ub[r.category],e.querySelector("#sizeValue").textContent=cb[r.age][r.gender][r.size],e.querySelector("#styleValue").textContent=lb[r.style],e.querySelector("#qualityValue").textContent=hb[r.quality],i.appendChild(e)}window.print(),window.onafterprint=()=>window.close()}else alert("Template not found!")}(r,parseInt(e),parseInt(n),{age:i,gender:o,category:s,size:a,style:u,quality:c}),!0)}async function yb(){let t=await async function(){let t=await J.firestore().doc("generation/latest").get();return{start:t.get("start"),end:t.get("end"),template:t.get("template"),userId:t.get("userId"),userName:t.get("userName")}}();document.querySelector("#start").value=(t.end+1).toString()}function vb(t){t?(document.querySelector("#settings").style.display="none",document.querySelector("#loading").style.display=""):(document.querySelector("#settings").style.display="",document.querySelector("#loading").style.display="none")}function gb(){let t=pb(Ed),e=pb(_d),n=document.getElementById("maleCategories"),r=document.getElementById("femaleCategories"),i=document.getElementById("babyСategories"),o=[n,r,i],s=null;s="adult"==e||"kid"==e?"male"===t?n:"female"===t?r:n:"baby"===e?i:r;for(let t of o)t.style.display=t==s?"":"none"}window.onGenderChange=gb,async function(){if(!db()){vb(!0);try{await yb(),vb(!1),document.querySelector("#generate")?.addEventListener("click",fb),gb()}catch(t){return void alert(t.message)}}}()}();
//# sourceMappingURL=app.js.map
